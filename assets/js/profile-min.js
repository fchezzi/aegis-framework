!function(){"use strict";const e=document.getElementById("avatar-input"),t=document.getElementById("avatar-form"),r=document.getElementById("avatar-img"),o=document.getElementById("btn-save-avatar");let a=null;e&&t&&(e.addEventListener("change",(function(t){const n=t.target.files[0];if(!n)return;if(!["image/jpeg","image/png","image/jpg","image/webp"].includes(n.type))return s("Apenas arquivos JPG, PNG ou WEBP são permitidos","error"),void(e.value="");if(n.size>2097152)return s("A imagem deve ter no máximo 2MB","error"),void(e.value="");const i=new FileReader;i.onload=function(e){if(r)r.src=e.target.result;else{document.querySelector(".avatar-preview").innerHTML='<img src="'+e.target.result+'" alt="Avatar" id="avatar-img">'}o.style.display="inline-flex",a=n},i.readAsDataURL(n)})),t.addEventListener("submit",(function(e){if(e.preventDefault(),!a)return void s("Selecione uma imagem primeiro","error");const r=new FormData(t),n=t.querySelector('button[type="submit"]');n.disabled=!0,n.classList.add("loading");const i=window.location.pathname.includes("/futebol-energia")?"/futebol-energia":"";fetch(i+"/profile/avatar",{method:"POST",body:r,credentials:"same-origin"}).then((e=>e.json())).then((e=>{e.success?(s(e.message,"success"),o.style.display="none",a=null,"undefined"!=typeof lucide&&lucide.createIcons()):s(e.error||"Erro ao atualizar avatar","error")})).catch((e=>{console.error("Erro:",e),s("Erro ao conectar com o servidor","error")})).finally((()=>{n.disabled=!1,n.classList.remove("loading")}))})));const n=document.getElementById("password-form");function s(e,t){document.querySelectorAll(".alert").forEach((e=>e.remove()));const r=document.createElement("div");r.className="alert alert-"+t,r.textContent=e;const o=document.querySelector(".profile-section");o&&(o.insertBefore(r,o.firstChild),setTimeout((()=>{r.style.transition="opacity 0.3s ease",r.style.opacity="0",setTimeout((()=>r.remove()),300)}),5e3),r.scrollIntoView({behavior:"smooth",block:"nearest"}))}n&&n.addEventListener("submit",(function(e){e.preventDefault();const t=document.getElementById("current-password").value,r=document.getElementById("new-password").value,o=document.getElementById("confirm-password").value;if(!t||!r||!o)return void s("Preencha todos os campos","error");if(r.length<8)return void s("A nova senha deve ter no mínimo 8 caracteres","error");if(r!==o)return void s("As senhas não coincidem","error");const a=new FormData(n),i=n.querySelector('button[type="submit"]');i.disabled=!0,i.classList.add("loading");const l=window.location.pathname.includes("/futebol-energia")?"/futebol-energia":"";fetch(l+"/profile/password",{method:"POST",body:a,credentials:"same-origin"}).then((e=>e.json())).then((e=>{e.success?(s(e.message,"success"),n.reset()):s(e.error||"Erro ao atualizar senha","error")})).catch((e=>{console.error("Erro:",e),s("Erro ao atualizar senha: "+e.message,"error")})).finally((()=>{i.disabled=!1,i.classList.remove("loading")}))}))}();