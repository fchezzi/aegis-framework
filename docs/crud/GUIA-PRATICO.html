<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
	<meta charset="utf-8"/>
</head>
<body>

<h1 id="guiapr√Åtico-refatorarcriarcrud">GUIA PR√ÅTICO - REFATORAR/CRIAR CRUD</h1>

<p><strong>Use este documento como seu ponto de partida.</strong> Ele cont√©m a ordem exata de a√ß√µes e checklists para refatorar um CRUD existente ou criar um novo.</p>

<hr />

<h2 id="‚ö†Ô∏èinstru√á√ïesobrigat√ìriasparaclaude">‚ö†Ô∏è INSTRU√á√ïES OBRIGAT√ìRIAS PARA CLAUDE</h2>

<p><strong>QUANDO O USU√ÅRIO PEDIR &#8220;CRIE CRUD DE X&#8221; OU &#8220;IMPLEMENTE CRUD DE Y&#8221;:</strong></p>

<h3 id="‚ùån√Éofa√áaisso:">‚ùå N√ÉO FA√áA ISSO:</h3>

<ul>
<li>Criar c√≥digo imediatamente</li>
<li>&#8220;J√° sei fazer, n√£o preciso do guia&#8221;</li>
<li>Pular passos para ir mais r√°pido</li>
<li>Marcar como completo sem testar</li>
</ul>

<h3 id="‚úÖfa√áaissoobrigat√ìrio:">‚úÖ FA√áA ISSO (OBRIGAT√ìRIO):</h3>

<p><strong>1. ANUNCIAR QUE VAI SEGUIR O GUIA:</strong></p>

<pre><code>&quot;Vou seguir o GUIA-PRATICO.md rigorosamente.
Iniciando PASSO -2: Coletar requisitos...&quot;
</code></pre>

<p><strong>2. ABRIR CHECKLIST DE EXECU√á√ÉO:</strong></p>

<pre><code>&quot;Abrindo CHECKLIST-EXECUCAO.md para tracking...&quot;
</code></pre>

<p><strong>3. REPORTAR CADA PASSO:</strong></p>

<pre><code>&quot;PASSO 4 [3/9]: Sanitiza√ß√£o completa ‚úì&quot;
&quot;PASSO 4 [6/9]: Logger.audit() adicionado ‚úì&quot;
</code></pre>

<p><strong>4. PARAR EM CADA CHECKPOINT:</strong></p>

<pre><code>&quot;‚õî CHECKPOINT CSRF:
[ ] validateCSRF() como primeira linha? ‚úì
[ ] Localiza√ß√£o correta? ‚úì
CHECKPOINT APROVADO. Prosseguindo...&quot;
</code></pre>

<p><strong>5. ANUNCIAR GATES:</strong></p>

<pre><code>&quot;üîí GATE PASSO 8: Iniciando valida√ß√£o...
Checkpoint 1/3: Seguran√ßa Cr√≠tica... ‚úì
Checkpoint 2/3: Valida√ß√µes e Feedback... ‚úì
Checkpoint 3/3: Estrutura e Nomenclatura... ‚úì
GATE APROVADO. Liberado para PASSO 9.&quot;
</code></pre>

<p><strong>6. RODAR TESTES DO PASSO 12:</strong></p>

<pre><code>&quot;üß™ TESTE 1: Funcionalidade B√°sica
[ ] GET /admin/banners ‚Üí 200 OK ‚úì
[ ] POST create ‚Üí registro criado ‚úì
...

üß™ TESTE 2: Seguran√ßa
[ ] CSRF bloqueou? ‚úì
[ ] Rate limit ativo? ‚úì
...&quot;
</code></pre>

<p><strong>7. VALIDA√á√ÉO AUTOM√ÅTICA (se dispon√≠vel):</strong></p>

<pre><code class="bash">php /scripts/validate-crud.php BannerController
</code></pre>

<h3 id="üö®importante">üö® IMPORTANTE</h3>

<p><strong>SE VOC√ä PULAR O GUIA:</strong></p>

<ul>
<li>‚ùå CRUD estar√° incompleto</li>
<li>‚ùå Faltar√° seguran√ßa (CSRF, RateLimit, Logger)</li>
<li>‚ùå Usu√°rio ter√° que debugar e corrigir</li>
<li>‚ùå Perda de confian√ßa</li>
</ul>

<p><strong>SE VOC√ä SEGUIR O GUIA:</strong></p>

<ul>
<li>‚úÖ CRUD 98% correto de primeira</li>
<li>‚úÖ Todas camadas de seguran√ßa</li>
<li>‚úÖ Auditoria completa</li>
<li>‚úÖ C√≥digo pronto para produ√ß√£o</li>
</ul>

<p><strong>O guia existe para VOC√ä n√£o errar. Use-o.</strong></p>

<hr />

<h2 id="üìãantesdecome√áar">üìã ANTES DE COME√áAR</h2>

<p><strong>‚ö†Ô∏è ABRA AGORA E MANTENHA VIS√çVEL:</strong></p>

<pre><code>/docs/crud/CHECKLIST-EXECUCAO.md
</code></pre>

<p>Voc√™ vai marcar cada checkbox conforme avan√ßa.</p>

<p><strong>S√≥ entregue o CRUD se TODOS os checkboxes estiverem marcados ‚úì</strong></p>

<hr />

<h2 id="passo-2:fazerperguntasecoletarrequisitos">PASSO -2: FAZER PERGUNTAS E COLETAR REQUISITOS</h2>

<h3 id="‚ö†Ô∏èverdadeabsolutasobrecrudemaegis">‚ö†Ô∏è VERDADE ABSOLUTA SOBRE CRUD EM AEGIS</h3>

<p><strong>Existe UM √∫nico padr√£o para criar CRUDs:</strong></p>

<ol>
<li><strong>Local sempre</strong>: <code>/admin/controllers/[Recurso]Controller.php</code></li>
<li><strong>M√©todos sempre</strong>: <code>index</code>, <code>create</code>, <code>store</code>, <code>edit</code>, <code>update</code>, <code>destroy</code> (6 m√©todos, sempre)</li>
<li><strong>Heran√ßa sempre</strong>: <code>BaseController</code></li>
<li><strong>O que muda</strong>: Nome da tabela, campos, valida√ß√µes espec√≠ficas</li>
<li><strong>O que N√ÉO muda</strong>: A estrutura dos 6 m√©todos √© ID√äNTICA</li>
</ol>

<p><strong>Ponto cr√≠tico: O CRUD n√£o sabe (nem precisa saber) ONDE seus dados v√£o ser exibidos.</strong></p>

<hr />

<h3 id="üéØoqueumcrudfaz">üéØ O Que um CRUD Faz</h3>

<p>‚úÖ Gerenciar dados (create, read, update, delete)
‚úÖ Exibir em admin (<code>/admin/recurso</code>)
‚úÖ Fornecer dados para qualquer outra p√°gina consumir</p>

<p>‚ùå Decidir onde exibir
‚ùå Decidir como exibir (carrossel, lista, grid)
‚ùå Conhecer quem vai consumir seus dados</p>

<hr />

<h3 id="üîÑcomofuncionaaexibi√ß√£o">üîÑ Como Funciona a Exibi√ß√£o</h3>

<p><strong>Se voc√™ quer exibir banners na home:</strong></p>

<pre><code>1. O CRUD (BannerController) gerencia banners
   ‚Üí /admin/banners (gerenciar)
   ‚Üí $controller-&gt;index() retorna todos os banners

2. A HOME (home.php) quer exibir banners
   ‚Üí Chama o m√©todo que precisa: $controller-&gt;index()
   ‚Üí O CRUD n√£o sabe que √© na home
   ‚Üí O CRUD n√£o sabe se √© carrossel, lista ou grid
   ‚Üí Aquilo √© responsabilidade da HOME decidir
</code></pre>

<p><strong>Analogia: Restaurante</strong></p>

<ul>
<li>CRUD = cozinha (produz pratos)</li>
<li>Home = uma mesa (pede prato do restaurante)</li>
<li>Blog = outra mesa (pede prato do restaurante)</li>
<li>Relat√≥rio = outra mesa (pede prato do restaurante)</li>
</ul>

<p><strong>A cozinha N√ÉO sabe (nem precisa saber) qual mesa vai comer o prato.</strong></p>

<hr />

<h3 id="‚ö†Ô∏èoque√âumcrud">‚ö†Ô∏è O QUE √â UM CRUD</h3>

<p><strong>Um CRUD SEMPRE ter√° os 6 m√©todos:</strong></p>

<ul>
<li><code>index</code> (listar todos)</li>
<li><code>create</code> (exibir formul√°rio de cria√ß√£o)</li>
<li><code>store</code> (processar POST de cria√ß√£o)</li>
<li><code>edit</code> (exibir formul√°rio de edi√ß√£o)</li>
<li><code>update</code> (processar POST de edi√ß√£o)</li>
<li><code>destroy</code> (processar DELETE)</li>
</ul>

<p><strong>Se voc√™ pediu &#8220;CRUD&#8221;, vai ter os 6 m√©todos. Sempre.</strong></p>

<hr />

<h3 id="üìãperguntasobrigat√≥rias">üìã Perguntas Obrigat√≥rias</h3>

<pre><code>1Ô∏è‚É£  NOME do CRUD (para identifica√ß√£o):

    ‚ùì POR QU√ä PERGUNTAR ISSO?
    Este nome ser√° usado em coment√°rios, documenta√ß√£o e para refer√™ncia.
    Ajuda a diferenciar quando voc√™ tem v√°rios CRUDs parecidos.

    üìù COMO RESPONDER:
    - Use nome descritivo que explica O QUE √â + ONDE/COMO USA
    - Pode ser composto (2-4 palavras)
    - Pense: &quot;Se eu ver este nome daqui 6 meses, vou lembrar o que √©?&quot;

    ‚úÖ EXEMPLOS REAIS:
    - &quot;Banner Hero Homepage&quot; (banner principal que vai na home)
    - &quot;Depoimentos Clientes Rodap√©&quot; (depoimentos que aparecem no footer)
    - &quot;Produtos Loja Virtual&quot; (produtos do e-commerce)
    - &quot;Parceiros Logos&quot; (logos de parceiros/clientes)
    - &quot;FAQ Perguntas Frequentes&quot; (se√ß√£o de d√∫vidas)
    - &quot;Galeria Fotos Projetos&quot; (galeria de imagens de trabalhos)

    ‚ùå EVITE:
    - &quot;Banner&quot; (muito gen√©rico, qual banner?)
    - &quot;Dados&quot; (n√£o diz nada)
    - &quot;Conte√∫do&quot; (muito vago)

---

2Ô∏è‚É£  O QUE √© este recurso (nome t√©cnico)?

    ‚ùì POR QU√ä PERGUNTAR ISSO?
    Este ser√° o nome t√©cnico usado em:
    - Nome da tabela no banco (ex: banners)
    - Nome do controller (ex: BannerController.php)
    - Rotas (ex: /admin/banners)
    - Vari√°veis no c√≥digo (ex: $banner, $banners)

    üìù COMO RESPONDER:
    - UMA palavra, no singular
    - Sem espa√ßos, sem caracteres especiais
    - Primeira letra mai√∫scula
    - Em portugu√™s (padr√£o AEGIS)

    ‚úÖ EXEMPLOS REAIS:
    - Banner
    - Depoimento
    - Produto
    - Categoria
    - Parceiro
    - Servico (sem √ß)
    - Artigo
    - Pergunta
    - Galeria

    ‚ùå EVITE:
    - &quot;Banner Hero&quot; (2 palavras)
    - &quot;banner&quot; (min√∫scula)
    - &quot;Banners&quot; (plural)
    - &quot;Servi√ßo&quot; (caractere especial √ß)

---

3Ô∏è‚É£  QUEM acessa o admin deste CRUD?

    ‚ùì POR QU√ä PERGUNTAR ISSO?
    Define qual n√≠vel de permiss√£o √© necess√°rio para gerenciar este recurso.

    üìù OP√á√ïES DISPON√çVEIS:

    [ ] Admin geral (Auth::require()) ‚Üê PADR√ÉO - ESCOLHA ESTA 99% DAS VEZES
        ‚Üí Qualquer usu√°rio logado no admin pode gerenciar
        ‚Üí Exemplos: Banners, Produtos, Depoimentos, Categorias
        ‚Üí Usado em: 95% dos CRUDs normais

    [ ] Apenas super admin (Role check)
        ‚Üí Somente super admins podem gerenciar
        ‚Üí Exemplos: Usu√°rios do Sistema, Configura√ß√µes Globais, Logs de Auditoria
        ‚Üí Usado em: Recursos cr√≠ticos ou sens√≠veis

    [ ] Propriet√°rios de conte√∫do (Permission check)
        ‚Üí Usu√°rios s√≥ gerenciam o pr√≥prio conte√∫do
        ‚Üí Exemplos: Autores veem apenas pr√≥prios Artigos, Vendedores veem apenas pr√≥prias Vendas
        ‚Üí Usado em: Sistemas multi-usu√°rio com isolamento de dados

    ‚úÖ COMO RESPONDER:
    - Na d√∫vida? Escolha &quot;Admin geral&quot;
    - √â configura√ß√£o cr√≠tica do sistema? Escolha &quot;Super admin&quot;
    - √â conte√∫do por usu√°rio? Escolha &quot;Propriet√°rios&quot;

---

4Ô∏è‚É£  QUAIS s√£o os campos necess√°rios?

    ‚ùì POR QU√ä PERGUNTAR ISSO?
    Define a estrutura da tabela do banco e dos formul√°rios admin.

    üìù COMO RESPONDER:
    Liste TODOS os campos que precisa, indicando:
    - Nome do campo
    - Tipo (ver lista abaixo)
    - Obrigat√≥rio ou Opcional

    üìã FORMATO DE RESPOSTA:
    - title (VARCHAR 255, obrigat√≥rio) - T√≠tulo principal
    - subtitle (VARCHAR 255, opcional) - Subt√≠tulo secund√°rio
    - image (VARCHAR 255 path, obrigat√≥rio) - Imagem de destaque
    - order (INT, obrigat√≥rio) - Ordem de exibi√ß√£o
    - ativo (TINYINT 1/0, obrigat√≥rio) - Status ativo/inativo

    üí° TIPOS DE CAMPOS DISPON√çVEIS:

    üìù TEXTO CURTO (VARCHAR 255):
    ‚úÖ title ‚Üí &quot;T√≠tulo do Banner Hero&quot;
    ‚úÖ name ‚Üí &quot;Jo√£o da Silva&quot;
    ‚úÖ subtitle ‚Üí &quot;Subt√≠tulo opcional&quot;
    ‚úÖ email ‚Üí &quot;contato@empresa.com&quot;
    ‚úÖ url ‚Üí &quot;https://site.com/pagina&quot;
    ‚úÖ slug ‚Üí &quot;meu-produto-incrivel&quot;

    Quando usar: Textos at√© 255 caracteres (t√≠tulos, nomes, links, emails)

    üìù TEXTO LONGO (TEXT):
    ‚úÖ description ‚Üí &quot;Esta √© uma descri√ß√£o longa do produto com v√°rios par√°grafos...&quot;
    ‚úÖ content ‚Üí &quot;Conte√∫do completo do artigo com formata√ß√£o...&quot;
    ‚úÖ bio ‚Üí &quot;Biografia completa do autor...&quot;
    ‚úÖ notes ‚Üí &quot;Observa√ß√µes internas...&quot;

    Quando usar: Textos longos, par√°grafos, descri√ß√µes detalhadas

    üî¢ N√öMEROS INTEIROS (INT):
    ‚úÖ order ‚Üí 1, 2, 3 (ordem de exibi√ß√£o)
    ‚úÖ quantity ‚Üí 50 (quantidade em estoque)
    ‚úÖ views ‚Üí 1523 (contador de visualiza√ß√µes)
    ‚úÖ age ‚Üí 25 (idade)

    Quando usar: N√∫meros sem casas decimais

    üî¢ N√öMEROS DECIMAIS (DECIMAL):
    ‚úÖ price ‚Üí 99.90 (pre√ßo de produto)
    ‚úÖ rating ‚Üí 4.5 (avalia√ß√£o de 0 a 5)
    ‚úÖ percentage ‚Üí 15.75 (porcentagem)

    Quando usar: N√∫meros com casas decimais (pre√ßos, notas, porcentagens)

    üìÖ DATA E HORA (DATETIME):
    ‚úÖ published_at ‚Üí &quot;2025-03-15 14:30:00&quot; (quando foi publicado)
    ‚úÖ expires_at ‚Üí &quot;2025-12-31 23:59:59&quot; (quando expira)
    ‚úÖ event_date ‚Üí &quot;2025-06-20 19:00:00&quot; (data do evento)

    Quando usar: Datas com hor√°rio espec√≠fico

    üìÖ APENAS DATA (DATE):
    ‚úÖ birth_date ‚Üí &quot;1990-05-15&quot; (data de nascimento)
    ‚úÖ deadline ‚Üí &quot;2025-08-30&quot; (prazo sem hora)

    Quando usar: Datas sem necessidade de hor√°rio

    üîò VERDADEIRO/FALSO (TINYINT 1/0):
    ‚úÖ ativo ‚Üí 1 (sim, est√° ativo) ou 0 (n√£o, est√° inativo)
    ‚úÖ featured ‚Üí 1 (destaque) ou 0 (n√£o destaque)
    ‚úÖ published ‚Üí 1 (publicado) ou 0 (rascunho)
    ‚úÖ visible ‚Üí 1 (vis√≠vel) ou 0 (oculto)

    Quando usar: Campos de sim/n√£o, ligado/desligado, ativo/inativo

    üìÅ UPLOAD DE IMAGEM (VARCHAR 255 path):
    ‚úÖ image ‚Üí &quot;/storage/uploads/banners/banner_123.jpg&quot;
    ‚úÖ avatar ‚Üí &quot;/storage/uploads/users/avatar_456.png&quot;
    ‚úÖ logo ‚Üí &quot;/storage/uploads/parceiros/logo_789.webp&quot;
    ‚úÖ thumbnail ‚Üí &quot;/storage/uploads/produtos/thumb_012.jpg&quot;

    Quando usar: Upload de imagens (JPG, PNG, GIF, WEBP)
    Importante: O campo guarda o CAMINHO do arquivo, n√£o o arquivo

    üìÅ UPLOAD DE ARQUIVO (VARCHAR 255 path):
    ‚úÖ pdf ‚Üí &quot;/storage/uploads/documentos/catalogo.pdf&quot;
    ‚úÖ document ‚Üí &quot;/storage/uploads/contratos/contrato_123.docx&quot;
    ‚úÖ attachment ‚Üí &quot;/storage/uploads/anexos/arquivo.zip&quot;

    Quando usar: Upload de PDFs, documentos, arquivos em geral
    Importante: O campo guarda o CAMINHO do arquivo, n√£o o arquivo

    üîó RELACIONAMENTO (CHAR 36 UUID):
    ‚úÖ user_id ‚Üí &quot;550e8400-e29b-41d4-a716-446655440000&quot; (qual usu√°rio criou)
    ‚úÖ category_id ‚Üí &quot;6ba7b810-9dad-11d1-80b4-00c04fd430c8&quot; (qual categoria pertence)
    ‚úÖ author_id ‚Üí &quot;7c9e6679-7425-40de-944b-e07fc1f90ae7&quot; (qual autor escreveu)
    ‚úÖ parent_id ‚Üí &quot;123e4567-e89b-12d3-a456-426614174000&quot; (categoria pai em hierarquia)

    Quando usar: Relacionamento com outra tabela (Foreign Key)
    Importante: AEGIS usa UUID (36 caracteres), n√£o INT auto increment

    üé® COR HEXADECIMAL (VARCHAR 7):
    ‚úÖ color ‚Üí &quot;#FF5733&quot; (cor de fundo)
    ‚úÖ text_color ‚Üí &quot;#FFFFFF&quot; (cor do texto)
    ‚úÖ border_color ‚Üí &quot;#000000&quot; (cor da borda)

    Quando usar: Campos de cor com color picker

    üé® DADOS JSON (TEXT):
    ‚úÖ settings ‚Üí {&quot;theme&quot;: &quot;dark&quot;, &quot;notifications&quot;: true}
    ‚úÖ metadata ‚Üí {&quot;views&quot;: 100, &quot;shares&quot;: 25}

    Quando usar: Dados estruturados complexos, configura√ß√µes din√¢micas

    üîó PARES DE CAMPOS (2 campos juntos):

    üí° CTA BUTTON:
    ‚úÖ button_text (VARCHAR 255) ‚Üí &quot;Saiba Mais&quot;
    ‚úÖ button_url (VARCHAR 255) ‚Üí &quot;https://site.com/produto&quot;

    Quando usar: Bot√µes de a√ß√£o que precisam texto E link

    üí° LINK COM TEXTO:
    ‚úÖ link_text (VARCHAR 255) ‚Üí &quot;Ver Detalhes&quot;
    ‚úÖ link_url (VARCHAR 255) ‚Üí &quot;/produtos/detalhes&quot;

    Quando usar: Links com texto customiz√°vel

    üí° TELEFONE COM LABEL:
    ‚úÖ phone_label (VARCHAR 255) ‚Üí &quot;WhatsApp&quot;
    ‚úÖ phone_number (VARCHAR 255) ‚Üí &quot;(11) 98765-4321&quot;

    Quando usar: Telefones com descri√ß√£o (Comercial, Celular, WhatsApp)

    üí° REDES SOCIAIS:
    ‚úÖ social_name (VARCHAR 255) ‚Üí &quot;Instagram&quot;
    ‚úÖ social_url (VARCHAR 255) ‚Üí &quot;https://instagram.com/empresa&quot;

    Quando usar: Links de redes sociais com nome da rede

    ‚úÖ EXEMPLO COMPLETO DE RESPOSTA (Banner):
    - title (VARCHAR 255, obrigat√≥rio) - T√≠tulo principal do banner
    - subtitle (VARCHAR 255, opcional) - Subt√≠tulo complementar
    - image (VARCHAR 255 path, obrigat√≥rio) - Imagem de fundo JPG/PNG/WEBP
    - button_text (VARCHAR 255, obrigat√≥rio) - Texto do bot√£o CTA
    - button_url (VARCHAR 255, obrigat√≥rio) - URL do bot√£o CTA
    - order (INT, obrigat√≥rio, default 0) - Ordem de exibi√ß√£o
    - ativo (TINYINT 1/0, obrigat√≥rio, default 1) - Status ativo/inativo

    ‚úÖ EXEMPLO COMPLETO DE RESPOSTA (Produto):
    - name (VARCHAR 255, obrigat√≥rio) - Nome do produto
    - description (TEXT, obrigat√≥rio) - Descri√ß√£o completa
    - price (DECIMAL 10,2, obrigat√≥rio) - Pre√ßo em reais
    - image (VARCHAR 255 path, obrigat√≥rio) - Foto principal
    - category_id (CHAR 36 UUID, obrigat√≥rio) - Categoria do produto
    - quantity (INT, obrigat√≥rio, default 0) - Estoque dispon√≠vel
    - featured (TINYINT 1/0, obrigat√≥rio, default 0) - Produto destaque
    - ativo (TINYINT 1/0, obrigat√≥rio, default 1) - Status ativo/inativo

---

5Ô∏è‚É£  COMPORTAMENTOS especiais?

    ‚ùì POR QU√ä PERGUNTAR ISSO?
    Alguns recursos precisam de funcionalidades extras al√©m do CRUD b√°sico.

    üìù COMO RESPONDER:
    Marque SIM ou N√ÉO para cada comportamento abaixo.

    [ ] Upload de arquivo? (SIM/N√ÉO)
        ‚Ü≥ Se SIM: Usar PASSO 4B (valida√ß√£o de upload)
        ‚Ü≥ Exemplos SIM: Banners (imagem), Documentos (PDF), Produtos (foto)
        ‚Ü≥ Exemplos N√ÉO: Categorias (s√≥ texto), Configura√ß√µes (s√≥ dados)

    [ ] Ordena√ß√£o/ranking? (SIM/N√ÉO)
        ‚Ü≥ Se SIM: Adicionar campo &quot;order&quot; (INT) na tabela
        ‚Ü≥ Exemplos SIM: Banners (ordem do carrossel), Depoimentos (ordem de exibi√ß√£o)
        ‚Ü≥ Exemplos N√ÉO: Produtos (ordenam por data), Artigos (ordenam por data)

    [ ] Status ativo/inativo? (SIM/N√ÉO)
        ‚Ü≥ Se SIM: Adicionar campo &quot;ativo&quot; (TINYINT 1/0) na tabela
        ‚Ü≥ Exemplos SIM: Quase TODOS os CRUDs (banners, produtos, categorias)
        ‚Ü≥ Exemplos N√ÉO: Logs (n√£o tem sentido ativar/desativar log)

    [ ] Datas especiais (published_at, expires_at)? (SIM/N√ÉO)
        ‚Ü≥ Se SIM: Adicionar campo(s) DATETIME na tabela
        ‚Ü≥ Exemplos SIM: Artigos (published_at), Promo√ß√µes (expires_at)
        ‚Ü≥ Exemplos N√ÉO: Categorias, Banners fixos

    [ ] Relacionamentos com outras tabelas? (SIM/N√ÉO, quais?)
        ‚Ü≥ Se SIM: Adicionar campo(s) _id (CHAR 36 UUID) na tabela
        ‚Ü≥ Exemplos SIM:
            - Produtos ‚Üí category_id (relaciona com categorias)
            - Artigos ‚Üí author_id (relaciona com usu√°rios)
            - Coment√°rios ‚Üí post_id (relaciona com posts)
        ‚Ü≥ Exemplos N√ÉO: Categorias standalone, Configura√ß√µes globais

    ‚úÖ EXEMPLO COMPLETO DE RESPOSTA (Banner):
    [X] Upload de arquivo? SIM (imagem JPG/PNG/WEBP, m√°ximo 5MB)
    [X] Ordena√ß√£o/ranking? SIM (campo &quot;order&quot;)
    [X] Status ativo/inativo? SIM (campo &quot;ativo&quot;)
    [ ] Datas especiais? N√ÉO
    [ ] Relacionamentos? N√ÉO

    ‚úÖ EXEMPLO COMPLETO DE RESPOSTA (Artigo):
    [X] Upload de arquivo? SIM (imagem destaque JPG/PNG, m√°ximo 2MB)
    [ ] Ordena√ß√£o/ranking? N√ÉO (ordena por published_at)
    [X] Status ativo/inativo? SIM (campo &quot;ativo&quot;)
    [X] Datas especiais? SIM (published_at DATETIME)
    [X] Relacionamentos? SIM (category_id, author_id)

---

6Ô∏è‚É£  Vai ter DISPLAY FRONTEND?

    ‚ùì POR QU√ä PERGUNTAR ISSO?
    Define se este recurso ser√° exibido no site (frontend) ou √© apenas gerenciamento (admin).

    üìù OP√á√ïES DISPON√çVEIS:

    [ ] N√ÉO ‚Üí Pronto, s√≥ existe o CRUD Admin
        ‚Ü≥ Quando usar: Recursos apenas de gerenciamento interno
        ‚Ü≥ Exemplos:
            - Usu√°rios do sistema (admin apenas)
            - Configura√ß√µes globais (admin apenas)
            - Logs de auditoria (admin apenas)
            - Permiss√µes (admin apenas)
        ‚Ü≥ Resultado: Apenas BannerController com 6 m√©todos admin

    [ ] SIM ‚Üí Criar partial reutiliz√°vel + preview no admin
        ‚Ü≥ Quando usar: Recursos que aparecem no site
        ‚Ü≥ Exemplos:
            - Banners (carrossel na home)
            - Depoimentos (se√ß√£o de feedback)
            - Produtos (listagem na loja)
            - Parceiros (logos no rodap√©)
            - FAQ (p√°gina de d√∫vidas)
        ‚Ü≥ Resultado:
            1. BannerController (admin CRUD)
            2. FrontendBannerController (fornece dados ativos)
            3. /views/partials/banner-hero.php (componente reutiliz√°vel)
            4. /assets/sass/frontend/components/_banner-hero.sass (estilos)
            5. Preview no admin com c√≥digo para copiar

    ‚ö†Ô∏è NOVA ABORDAGEM AEGIS:
    - N√ÉO perguntamos mais &quot;onde vai aparecer?&quot; (home, blog, etc)
    - N√ÉO acoplamos a p√°gina espec√≠fica
    - Criamos PARTIAL GEN√âRICA que funciona em qualquer lugar
    - Preview no admin mostra c√≥digo pronto:
      &lt;?php include __DIR__ . '/partials/banner-hero.php'; ?&gt;
    - Usu√°rio DECIDE onde usar: home, m√∫ltiplas p√°ginas, includes, etc

    ‚úÖ EXEMPLO DE RESPOSTA (Banner):
    [X] SIM - Vai aparecer no frontend
        ‚Üí Criar FrontendBannerController
        ‚Üí Criar /views/partials/banner-hero.php
        ‚Üí Criar /assets/sass/frontend/components/_banner-hero.sass
        ‚Üí Adicionar preview no admin/views/banners/index.php

    ‚úÖ EXEMPLO DE RESPOSTA (Usu√°rios):
    [ ] N√ÉO - Apenas gerenciamento admin
        ‚Üí S√≥ criar UserController com CRUD admin
        ‚Üí Sem display frontend
</code></pre>

<hr />

<h3 id="‚úÖexemplocorretodeplanejamento">‚úÖ Exemplo Correto de Planejamento</h3>

<p><strong>Cen√°rio: Criar Banner CRUD</strong></p>

<pre><code>User: Vou criar um CRUD de banners

Eu fa√ßo as perguntas:

1. Nome do CRUD? ‚Üí &quot;Banner Hero&quot;
2. Recurso t√©cnico? ‚Üí Banner (tabela: banners)
3. Quem acessa? ‚Üí Todos os admins
4. Quais campos? ‚Üí title, subtitle, image, cta_button, cta_url, order, ativo
5. Comportamentos? ‚Üí Upload (imagem JPG/PNG/GIF/WEBP 5MB), ordena√ß√£o, status
6. Display frontend? ‚Üí SIM

Meu plano:
‚úÖ 1. Criar tabela: banners
‚úÖ 2. Criar CRUD Admin: BannerController (6 m√©todos)
‚úÖ 3. Criar views admin: index, create, edit
‚úÖ 4. Adicionar 6 rotas admin
‚úÖ 5. Criar FrontendBannerController (getActive)
‚úÖ 6. Criar partial: banner-hero.php (carrossel reutiliz√°vel)
‚úÖ 7. Adicionar preview no admin/views/banners/index.php
‚úÖ 8. Preview mostra c√≥digo para copiar
‚úÖ 9. Usu√°rio decide onde usar (home, m√∫ltiplas p√°ginas, includes)

‚ö†Ô∏è NOVA ABORDAGEM: N√£o acoplamos a p√°gina espec√≠fica
‚ö†Ô∏è Partial pode ser usada em qualquer lugar
‚ö†Ô∏è Preview no admin + c√≥digo pronto para copiar
</code></pre>

<hr />

<h3 id="üìächecklistantesdecome√ßar">üìä Checklist Antes de Come√ßar</h3>

<pre><code>OBRIGAT√ìRIO:
[ ] Responder: Nome do CRUD (identifica√ß√£o)?
[ ] Responder: O que √© este recurso (t√©cnico)?
[ ] Responder: Quem acessa admin?
[ ] Responder: Quais campos?
[ ] Responder: Comportamentos especiais?

OPCIONAL:
[ ] Responder: Vai ter display frontend? (SIM/N√ÉO)

RESULTADO:
[ ] Entender que CRUD Admin √© SEMPRE em /admin/controllers/
[ ] Entender que CRUD SEMPRE tem 6 m√©todos
[ ] Entender que frontend √© respons√°vel por exibi√ß√£o
[ ] Entender que CRUD n√£o muda por causa do frontend
</code></pre>

<hr />

<h3 id="üöÄpr√≥ximopasso">üöÄ Pr√≥ximo Passo</h3>

<p>Responder as 6 perguntas acima ‚Üí Ir para PASSO -1</p>

<p><strong>Pr√≥ximo</strong>: Passo -1</p>

<hr />

<h2 id="passo-1:criartabelanobanco">PASSO -1: CRIAR TABELA NO BANCO</h2>

<h3 id="‚ö†Ô∏ècuidado:sqlreservedkeywords">‚ö†Ô∏è CUIDADO: SQL Reserved Keywords</h3>

<p><strong>NUNCA use nomes de colunas que sejam SQL reserved keywords sem BACKTICKS:</strong></p>

<pre><code class="sql">‚ùå ERRADO (vai quebrar):
SELECT * FROM banners WHERE order = 1

‚úÖ CORRETO (sempre com backticks):
SELECT * FROM banners WHERE `order` = 1
</code></pre>

<p><strong>Reserved keywords comuns:</strong></p>

<ul>
<li><code>order</code> - ORDER BY</li>
<li><code>group</code> - GROUP BY</li>
<li><code>key</code> - PRIMARY KEY</li>
<li><code>value</code> - valores</li>
<li><code>type</code> - tipos de dados</li>
<li><code>status</code> - estado</li>
</ul>

<p><strong>Se usar algum desses como coluna, SEMPRE usar backticks em TODAS as queries:</strong></p>

<ul>
<li>SQL: <code>`order`</code></li>
<li>PHP prepared: <code>?</code> (o backtick vai na SQL string)</li>
</ul>

<p><strong>‚õî CHECKPOINT OBRIGAT√ìRIO - N√ÉO PROSSIGA SEM COMPLETAR:</strong></p>

<pre><code class="sql">-- ‚úÖ CORRETO - backticks em reserved keywords
CREATE TABLE `banners` (
  `order` INT DEFAULT 0,  -- ‚Üê backticks
  KEY `idx_order` (`order`)  -- ‚Üê backticks
)

SELECT * FROM banners WHERE `order` = ?  -- ‚Üê backticks
SELECT * FROM banners ORDER BY `order` ASC  -- ‚Üê backticks

-- ‚ùå ERRADO - sem backticks
CREATE TABLE banners (
  order INT DEFAULT 0  -- ‚Üê ERRO! 35% DE CHANCE
)
SELECT * FROM banners WHERE order = ?  -- ‚Üê ERRO!
</code></pre>

<p><strong>CHECKLIST OBRIGAT√ìRIO (35% de chance de erro - VERIFICAR AGORA):</strong></p>

<pre><code>[ ] Tenho coluna com reserved keyword (order, group, key, value, type, status)?
[ ] Se SIM: TODAS as ocorr√™ncias t√™m backticks?
[ ] CREATE TABLE: `order` ‚úì
[ ] SELECT: WHERE `order` = ? ‚úì
[ ] ORDER BY: ORDER BY `order` ‚úì
[ ] INDEX: KEY `idx_order` (`order`) ‚úì

‚ö†Ô∏è SE ALGUMA QUERY N√ÉO TEM BACKTICKS, ADICIONE AGORA!
‚ö†Ô∏è ERRO DE BACKTICK = SQL SYNTAX ERROR = C√ìDIGO QUEBRADO!
</code></pre>

<h3 id="sqlmigration">SQL Migration</h3>

<p><strong>Crie o arquivo SQL em <code>/migrations/</code></strong></p>

<p>Exemplo: <code>/migrations/001_create_banners_table.sql</code></p>

<pre><code class="sql">CREATE TABLE IF NOT EXISTS `banners` (
  `id` CHAR(36) PRIMARY KEY COMMENT 'UUID v4',
  `title` VARCHAR(255) NOT NULL,
  `subtitle` VARCHAR(500),
  `image` VARCHAR(255),
  `cta_url` VARCHAR(255) NOT NULL,
  `cta_text` VARCHAR(100),
  `order` INT DEFAULT 0,
  `ativo` TINYINT(1) DEFAULT 1,
  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  KEY `idx_ativo` (`ativo`),
  KEY `idx_order` (`order`),
  KEY `idx_created` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
</code></pre>

<h3 id="checklistdesql">Checklist de SQL</h3>

<pre><code>[ ] Nenhuma coluna com reserved keyword SEM backticks
[ ] Se usar reserved keyword, documentar que precisa backtick em queries
[ ] Charset: utf8mb4
[ ] Collation: utf8mb4_unicode_ci
[ ] √çndices em colunas frequently queried
</code></pre>

<h3 id="executarmigration">Executar Migration</h3>

<pre><code class="bash">php /scripts/migrate.php
</code></pre>

<p>OU manualmente no MySQL:</p>

<pre><code class="bash">mysql -u root -p -S /Applications/MAMP/tmp/mysql/mysql.sock &lt; /migrations/001_create_banners_table.sql
</code></pre>

<h3 id="checklist">Checklist</h3>

<pre><code>[ ] Arquivo SQL criado em /migrations/
[ ] Tabela criada no banco
[ ] Colunas corretas
[ ] PRIMARY KEY √© UUID (CHAR(36))
[ ] Campos obrigat√≥rios SEM NULL
[ ] Campos opcionais COM NULL
[ ] Timestamps: created_at, updated_at
[ ] √çndices em: ativo, order, created_at (ou relevantes para query)
[ ] Charset: utf8mb4
[ ] Collation: utf8mb4_unicode_ci
</code></pre>

<hr />

<h2 id="passo0:prepara√á√Éo">PASSO 0: PREPARA√á√ÉO</h2>

<h3 id="informa√ß√µesdocrud">Informa√ß√µes do CRUD</h3>

<pre><code>[ ] Nome do recurso: _________________________
[ ] Tipo: [ ] Admin [ ] Module [ ] API
[ ] Arquivo atual/novo: _________________________
</code></pre>

<p><strong>Se for refatorar:</strong></p>

<pre><code>[ ] Abra o arquivo atual em um editor
[ ] Identifique os 5-6 m√©todos existentes
</code></pre>

<p><strong>Se for criar novo:</strong></p>

<pre><code>[ ] Decida o tipo (Admin/Module/API)
[ ] Crie arquivo vazio
</code></pre>

<hr />

<h2 id="passo0.5:verificarnomesdeclassescr√çtico">PASSO 0.5: VERIFICAR NOMES DE CLASSES (CR√çTICO!)</h2>

<h3 id="‚ö†Ô∏èimportante:voc√™est√°criandoapenasadmincrud">‚ö†Ô∏è IMPORTANTE: Voc√™ Est√° Criando Apenas Admin CRUD</h3>

<p><strong>Este passo √© APENAS sobre Admin CRUD em <code>/admin/controllers/</code></strong></p>

<p>Se no futuro precisar de Frontend Display, ser√° um Passo separado (PASSO 11B).</p>

<h3 id="checklist:antesdecriaraclasse">Checklist: Antes de Criar a Classe</h3>

<pre><code>[ ] Pesquisar: o nome desta classe j√° existe em /admin/controllers/?
    find /admin/controllers -name &quot;*BannerController*&quot; -type f

[ ] Se n√£o existe: usar nome simples
    Correto: BannerController
    Arquivo: /admin/controllers/BannerController.php

[ ] O ARQUIVO deve ter EXATAMENTE o mesmo nome da CLASSE
    Classe: BannerController ‚Üí Arquivo: BannerController.php

[ ] Confirmado que √© um nome √öNICO em /admin/controllers/?
</code></pre>

<hr />

<h2 id="passo0.6:regrasobrigat√ìriasparaviewsadmin">PASSO 0.6: REGRAS OBRIGAT√ìRIAS PARA VIEWS ADMIN</h2>

<h3 id="‚ö†Ô∏ècritical:pathsdeincludesnasviews">‚ö†Ô∏è CRITICAL: Paths de Includes nas Views</h3>

<p><strong>Views admin ficam em:</strong> <code>/admin/views/{resource}/</code>
<strong>Includes admin ficam em:</strong> <code>/admin/includes/</code></p>

<p><strong>De <code>admin/views/{resource}/</code> at√© <code>admin/includes/</code> = 2 N√çVEIS ACIMA</strong></p>

<pre><code class="php">// ‚úÖ CORRETO (2 n√≠veis: ../.. )
require_once __DIR__ . '/../../includes/_admin-head.php';
require_once __DIR__ . '/../../includes/header.php';

// ‚ùå ERRADO (3 n√≠veis - vai para raiz!)
require_once __DIR__ . '/../../../includes/_admin-head.php';
</code></pre>

<p><strong>Estrutura:</strong></p>

<pre><code>admin/
‚îú‚îÄ‚îÄ views/
‚îÇ   ‚îî‚îÄ‚îÄ banners/          ‚Üê Voc√™ est√° AQUI
‚îÇ       ‚îú‚îÄ‚îÄ index.php
‚îÇ       ‚îú‚îÄ‚îÄ create.php
‚îÇ       ‚îî‚îÄ‚îÄ edit.php
‚îú‚îÄ‚îÄ includes/             ‚Üê Quer chegar AQUI
‚îÇ   ‚îú‚îÄ‚îÄ _admin-head.php
‚îÇ   ‚îî‚îÄ‚îÄ header.php
‚îî‚îÄ‚îÄ controllers/
</code></pre>

<p><strong>De <code>banners/</code> at√© <code>includes/</code>:</strong></p>

<ol>
<li><code>../</code> = sobe para <code>views/</code></li>
<li><code>../</code> = sobe para <code>admin/</code></li>
<li><code>includes/</code> = entra em <code>includes/</code></li>
</ol>

<p><strong>Total: <code>../../includes/</code></strong> (N√ÉO <code>../../../</code>)</p>

<h3 id="‚ö†Ô∏ècritical:vari√°veisobrigat√≥riasparaviewsadmin">‚ö†Ô∏è CRITICAL: Vari√°veis Obrigat√≥rias para Views Admin</h3>

<p><strong>TODAS as views admin que incluem <code>header.php</code> precisam de <code>$user</code> definida.</strong></p>

<p><strong>No Controller, ANTES de <code>require view.php</code>:</strong></p>

<pre><code class="php">// ‚úÖ CORRETO - Sempre definir $user
public function index() {
    Auth::require();
    $user = Auth::user();  // ‚Üê OBRIGAT√ìRIO!

    $items = $this-&gt;db()-&gt;query(&quot;SELECT * FROM items&quot;);

    require __DIR__ . '/../views/items/index.php';
}

public function create() {
    Auth::require();
    $user = Auth::user();  // ‚Üê OBRIGAT√ìRIO!

    require __DIR__ . '/../views/items/create.php';
}

public function edit($id) {
    Auth::require();
    $user = Auth::user();  // ‚Üê OBRIGAT√ìRIO!

    $item = $this-&gt;db()-&gt;selectOne('items', ['id' =&gt; $id]);

    require __DIR__ . '/../views/items/edit.php';
}

// ‚ùå ERRADO - Sem $user
public function index() {
    Auth::require();
    // Faltou: $user = Auth::user();

    require __DIR__ . '/../views/items/index.php';  // ERRO!
}
</code></pre>

<p><strong>Por qu√™?</strong></p>

<p><code>/admin/includes/header.php</code> usa:</p>

<pre><code class="php">&lt;span&gt;Ol√°, &lt;?= htmlspecialchars($user['name']) ?&gt;&lt;/span&gt;
</code></pre>

<p>Se <code>$user</code> n√£o existir = <strong>ErrorException: Undefined variable $user</strong></p>

<h3 id="‚ö†Ô∏ècritical:logger√©opcionaln√£oobrigat√≥rio">‚ö†Ô∏è CRITICAL: Logger √© OPCIONAL (N√£o Obrigat√≥rio)</h3>

<p><strong>Logger N√ÉO √© est√°tico. Se for usar, precisa getInstance():</strong></p>

<pre><code class="php">// ‚úÖ CORRETO - Se quiser log de auditoria
Logger::getInstance()-&gt;audit('banner_created', Auth::user()['id'], [
    'banner_id' =&gt; $id,
    'title' =&gt; $title
]);

// ‚úÖ CORRETO - Sem logger (funciona tamb√©m)
// (simplesmente n√£o adicione Logger)

// ‚ùå ERRADO - Logger::audit() est√°tico
Logger::audit('banner_created', [...]);  // ERRO: Non-static method
</code></pre>

<p><strong>Logger √© OPCIONAL. Se n√£o adicionar, CRUD funciona normalmente.</strong></p>

<h3 id="checklistpr√©-views">Checklist Pr√©-Views</h3>

<pre><code>[ ] Paths de include corretos: ../../includes/ (2 n√≠veis)
[ ] $user = Auth::user() em index()
[ ] $user = Auth::user() em create()
[ ] $user = Auth::user() em edit()
[ ] BaseController: extends BaseController
[ ] Database: usar $this-&gt;db() (n√£o DB::connect())
[ ] Logger: OPCIONAL - se usar, getInstance()-&gt;audit()
</code></pre>

<hr />

<hr />

<h2 id="passo1:escolhertemplate">PASSO 1: ESCOLHER TEMPLATE</h2>

<p><strong>Consulte conforme seu tipo:</strong></p>

<ul>
<li>[ ] <strong>ADMIN</strong> ‚Üí Abra <code>/docs/crud/templates/TEMPLATE-CRUD-ADMIN.md</code></li>
<li>[ ] <strong>MODULE</strong> ‚Üí Abra <code>/docs/crud/templates/TEMPLATE-CRUD-MODULO.md</code></li>
<li>[ ] <strong>API</strong> ‚Üí Abra <code>/docs/crud/templates/TEMPLATE-CRUD-API.md</code></li>
</ul>

<p><strong>A√ß√£o</strong>: Copie a estrutura base do template para seu arquivo.</p>

<hr />

<h2 id="passo2:implementarm√âtodoindex">PASSO 2: IMPLEMENTAR M√âTODO index()</h2>

<h3 id="checklistdeimplementa√ß√£o">Checklist de Implementa√ß√£o</h3>

<pre><code>[ ] Autentica√ß√£o adicionada
  - Admin/Module: Auth::require() ou $this-&gt;requireAuth()
  - API: Auth::requireJWT()

[ ] Database query implementada
  - Usar prepared statements (?, placeholders)
  - SELECT com ORDER BY

[ ] Pagina√ß√£o (se muitos registros)
  - GET params: page, per_page
  - LIMIT ? OFFSET ?

[ ] Response estruturada
  - Admin/Module: render() ou require view
  - API: json(200, [...])
</code></pre>

<h3 id="valida√ß√£or√°pida">Valida√ß√£o R√°pida</h3>

<pre><code>[ ] N√£o tem SQL injection (sem concatena√ß√£o de strings)
[ ] N√£o tem XSS (outputs v√£o ser sanitizados na view)
</code></pre>

<p><strong>Pr√≥ximo</strong>: Passo 3</p>

<hr />

<h2 id="adminmoduleapenas">PASSO 3: IMPLEMENTAR M√âTODO create()</h2>

<h3 id="checklistdeimplementa√ß√£o">Checklist de Implementa√ß√£o</h3>

<pre><code>[ ] Autentica√ß√£o adicionada
  - Auth::require() ou $this-&gt;requireAuth()

[ ] Dados relacionados buscados (se necess√°rio)
  - Ex: categorias, grupos, tags

[ ] View renderizada com dados
  - Passar array de dados para render/require
</code></pre>

<h3 id="valida√ß√£or√°pida">Valida√ß√£o R√°pida</h3>

<pre><code>[ ] Nada de database write aqui (apenas leitura)
[ ] View vai ter form com CSRF token
</code></pre>

<p><strong>Pr√≥ximo</strong>: Passo 4</p>

<hr />

<h2 id="create">PASSO 4: IMPLEMENTAR M√âTODO store()</h2>

<h3 id="checklistemordemrigorosa">Checklist em Ordem Rigorosa</h3>

<h4 id="1csrfvalidation-primeiracoisa">[1] CSRF VALIDATION - PRIMEIRA COISA</h4>

<pre><code>[ ] C√≥digo adicionado:
  - Admin/Module: $this-&gt;validateCSRF()
  - API: (n√£o precisa, usa JWT)

[ ] Localiza√ß√£o: PRIMEIRA linha do try/catch
[ ] Sem exce√ß√£o: valida√ß√£o deve der antes de qualquer outra a√ß√£o
</code></pre>

<p><strong>‚õî CHECKPOINT OBRIGAT√ìRIO - N√ÉO PROSSIGA SEM COMPLETAR:</strong></p>

<pre><code class="php">// ‚úÖ CORRETO - CSRF como primeira linha
public function store() {
    $this-&gt;requireAuth();
    try {
        $this-&gt;validateCSRF(); // ‚Üê PRIMEIRA COISA
        // resto do c√≥digo...
    }
}

// ‚ùå ERRADO - CSRF depois de outras a√ß√µes
public function store() {
    $this-&gt;requireAuth();
    try {
        $name = $_POST['name'];
        $this-&gt;validateCSRF(); // ‚Üê TARDE DEMAIS
    }
}
</code></pre>

<p><strong>CHECKLIST DE SEGURAN√áA (40% de chance de erro - VERIFICAR AGORA):</strong></p>

<pre><code>[ ] Linha 1 do try √© $this-&gt;validateCSRF()? (NADA ANTES)
[ ] Se for API: posso pular CSRF (usa JWT)
[ ] Se for Admin/Module: CSRF √© OBRIGAT√ìRIO

‚ö†Ô∏è SE ALGUMA RESPOSTA FOR &quot;N√ÉO&quot;, VOLTE E CORRIJA AGORA!
</code></pre>

<h4 id="2ratelimiting-segundacoisa">[2] RATE LIMITING - SEGUNDA COISA</h4>

<pre><code>[ ] C√≥digo adicionado:
  - RateLimiter::check('recurso_create', $ip, 5, 60)
  - RateLimiter::increment('recurso_create', $ip, 60)

[ ] Localiza√ß√£o: Logo ap√≥s CSRF, antes de valida√ß√µes

[ ] Limite correto:
  - store/update/destroy: 5 tentativas em 60s
  - API index: 60 tentativas em 60s

[ ] HTTP 429 retornado se bloqueado
</code></pre>

<p><strong>‚õî CHECKPOINT OBRIGAT√ìRIO - N√ÉO PROSSIGA SEM COMPLETAR:</strong></p>

<pre><code class="php">// ‚úÖ CORRETO - check() e increment()
$ip = $_SERVER['REMOTE_ADDR'];
if (!RateLimiter::check('banner_create', $ip, 5, 60)) {
    http_response_code(429);
    die('Muitas requisi√ß√µes. Aguarde 1 minuto.');
}

// ... c√≥digo create ...

RateLimiter::increment('banner_create', $ip, 60); // ‚Üê DEPOIS do sucesso

// ‚ùå ERRADO - s√≥ check, sem increment
if (!RateLimiter::check(...)) { die(); }
// ... c√≥digo ...
// ESQUECEU increment() ‚Üê 20% DE CHANCE DESSE ERRO!
</code></pre>

<p><strong>CHECKLIST DE SEGURAN√áA (20% de chance de erro - VERIFICAR AGORA):</strong></p>

<pre><code>[ ] RateLimiter::check() existe ANTES de valida√ß√µes?
[ ] HTTP 429 retornado se bloqueado?
[ ] RateLimiter::increment() existe DEPOIS do insert?
[ ] Nome da a√ß√£o consistente ('banner_create' em ambos)?

‚ö†Ô∏è SE ESQUECEU increment(), VOLTE E ADICIONE AGORA!
</code></pre>

<h4 id="3sanitiza√á√Éo-antesdevalidar">[3] SANITIZA√á√ÉO - ANTES DE VALIDAR</h4>

<pre><code>[ ] Todos os inputs foram sanitizados:
  - Strings: Security::sanitize()
  - IDs/UUIDs: VALIDAR n√£o sanitizar
  - Passwords: N√ÉO sanitizar, hash depois

Exemplo correto:
  $name = Security::sanitize($_POST['name'] ?? '');
  $email = strtolower(Security::sanitize($_POST['email'] ?? ''));
</code></pre>

<hr />

<h2 id="passo4b:uploaddearquivossehouver">PASSO 4B: UPLOAD DE ARQUIVOS (SE HOUVER)</h2>

<h3 id="‚ö†Ô∏èquandousarestepasso">‚ö†Ô∏è QUANDO USAR ESTE PASSO</h3>

<p><strong>Use APENAS se seu CRUD tem upload de arquivos (imagem, PDF, etc).</strong></p>

<p>Se n√£o tem upload, <strong>pule para PASSO 4 item [4] VALIDA√á√ïES</strong>.</p>

<hr />

<h3 id="üìÅpadr√£odediret√≥riosaegis">üìÅ Padr√£o de Diret√≥rios AEGIS</h3>

<p><strong>SEMPRE salvar em:</strong></p>

<pre><code>/storage/uploads/[recurso_minusculo]/
</code></pre>

<p><strong>Exemplos:</strong></p>

<ul>
<li>Banners ‚Üí <code>/storage/uploads/banners/</code></li>
<li>Blog posts ‚Üí <code>/storage/uploads/blog/</code></li>
<li>Avatares de membros ‚Üí <code>/storage/uploads/members/</code></li>
<li>Logos ‚Üí <code>/storage/uploads/logos/</code></li>
</ul>

<p><strong>N√ÉO salvar em:</strong></p>

<ul>
<li>‚ùå <code>/public/uploads/</code> (inseguro)</li>
<li>‚ùå <code>/assets/uploads/</code> (n√£o √© asset)</li>
<li>‚ùå <code>/uploads/</code> (sem organiza√ß√£o)</li>
</ul>

<hr />

<h3 id="üîêseguran√ßadeuploadobrigat√ìrio">üîê Seguran√ßa de Upload (OBRIGAT√ìRIO)</h3>

<h4 id="valida√ß√µesantesdeaceitarupload">Valida√ß√µes ANTES de Aceitar Upload</h4>

<pre><code class="php">// [1] Verificar se arquivo foi enviado
if (empty($_FILES['image']) || $_FILES['image']['error'] !== UPLOAD_ERR_OK) {
    throw new Exception('Arquivo n√£o enviado ou erro no upload');
}

// [2] Validar tamanho (exemplo: 5MB)
$maxSize = 5 * 1024 * 1024; // 5MB em bytes
if ($_FILES['image']['size'] &gt; $maxSize) {
    throw new Exception('Arquivo muito grande. M√°ximo: 5MB');
}

// [3] Validar tipo MIME (CR√çTICO - previne upload de malware)
$allowedMimes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
$finfo = finfo_open(FILEINFO_MIME_TYPE);
$mimeType = finfo_file($finfo, $_FILES['image']['tmp_name']);
finfo_close($finfo);

if (!in_array($mimeType, $allowedMimes)) {
    throw new Exception('Tipo de arquivo n√£o permitido. Use: JPG, PNG, GIF, WEBP');
}

// [4] Validar extens√£o (dupla prote√ß√£o)
$extension = strtolower(pathinfo($_FILES['image']['name'], PATHINFO_EXTENSION));
$allowedExtensions = ['jpg', 'jpeg', 'png', 'gif', 'webp'];

if (!in_array($extension, $allowedExtensions)) {
    throw new Exception('Extens√£o n√£o permitida');
}
</code></pre>

<hr />

<h3 id="üìÇcriardiret√≥riodeuploadsen√£oexiste">üìÇ Criar Diret√≥rio de Upload (Se N√£o Existe)</h3>

<pre><code class="php">// Diret√≥rio base de uploads
$uploadDir = ROOT_PATH . 'storage/uploads/banners/';

// Criar diret√≥rio se n√£o existir
if (!is_dir($uploadDir)) {
    if (!mkdir($uploadDir, 0755, true)) {
        throw new Exception('Erro ao criar diret√≥rio de upload');
    }
}

// Verificar permiss√µes de escrita
if (!is_writable($uploadDir)) {
    throw new Exception('Diret√≥rio de upload sem permiss√£o de escrita');
}
</code></pre>

<hr />

<h3 id="üè∑Ô∏ègerarnome√önicoeseguro">üè∑Ô∏è Gerar Nome √önico e Seguro</h3>

<pre><code class="php">// NUNCA usar nome original do arquivo (risco de seguran√ßa)
// SEMPRE gerar nome √∫nico

// [1] Gerar UUID para o nome
$fileId = Security::generateUUID();

// [2] Adicionar timestamp (evita colis√µes mesmo com UUID)
$timestamp = time();

// [3] Adicionar extens√£o validada
$fileName = $fileId . '_' . $timestamp . '.' . $extension;

// [4] Path completo
$filePath = $uploadDir . $fileName;

// Exemplo de resultado:
// /storage/uploads/banners/a1b2c3d4-5678-90ab-cdef-1234567890ab_1707847200.jpg
</code></pre>

<hr />

<h3 id="üíæmoverarquivocomseguran√ßa">üíæ Mover Arquivo com Seguran√ßa</h3>

<pre><code class="php">// [1] Mover arquivo do temp para destino final
if (!move_uploaded_file($_FILES['image']['tmp_name'], $filePath)) {
    throw new Exception('Erro ao salvar arquivo');
}

// [2] Definir permiss√µes corretas (OBRIGAT√ìRIO)
chmod($filePath, 0644);
// 0644 = owner read+write, group read, others read
// Apache consegue ler ‚úÖ
// Ningu√©m consegue executar ‚úÖ

// [3] Salvar APENAS o path relativo no banco (N√ÉO o path absoluto)
$relativeFilePath = '/storage/uploads/banners/' . $fileName;

// Exemplo:
// ‚úÖ CORRETO: /storage/uploads/banners/abc123_1707847200.jpg
// ‚ùå ERRADO: /Users/fabio/Documents/aegis/storage/uploads/banners/abc123.jpg
</code></pre>

<hr />

<h3 id="üóÑÔ∏èsalvarpathnobancon√Éooarquivo">üóÑÔ∏è Salvar Path no Banco (N√ÉO o Arquivo)</h3>

<pre><code class="php">// IMPORTANTE: Salvar apenas o PATH, n√£o o conte√∫do do arquivo
$data = [
    'id' =&gt; $id,
    'title' =&gt; $title,
    'image' =&gt; $relativeFilePath,  // ‚Üê PATH, n√£o arquivo
    'created_at' =&gt; date('Y-m-d H:i:s')
];

$this-&gt;db()-&gt;insert('banners', $data);
</code></pre>

<hr />

<h3 id="üîÑupdate:deletararquivoantigo">üîÑ Update: Deletar Arquivo Antigo</h3>

<p><strong>Se for UPDATE e usu√°rio enviou novo arquivo:</strong></p>

<pre><code class="php">// [1] Buscar registro atual
$banner = $this-&gt;db()-&gt;select('banners', ['id' =&gt; $id]);

// [2] Se tinha imagem antiga E nova foi enviada
if (!empty($banner[0]['image']) &amp;&amp; !empty($_FILES['image']['tmp_name'])) {

    // [3] Deletar arquivo f√≠sico antigo
    $oldFilePath = ROOT_PATH . ltrim($banner[0]['image'], '/');

    if (file_exists($oldFilePath)) {
        unlink($oldFilePath);
    }
}

// [4] Processar novo upload (mesmo c√≥digo do CREATE)
</code></pre>

<hr />

<h3 id="üóëÔ∏èdelete:deletararquivof√≠sico">üóëÔ∏è Delete: Deletar Arquivo F√≠sico</h3>

<p><strong>No m√©todo destroy(), SEMPRE deletar arquivo f√≠sico:</strong></p>

<pre><code class="php">// [1] Buscar registro ANTES de deletar (para ter path do arquivo)
$banner = $this-&gt;db()-&gt;select('banners', ['id' =&gt; $id]);

if (empty($banner)) {
    throw new Exception('Banner n√£o encontrado');
}

// [2] Deletar arquivo f√≠sico PRIMEIRO
if (!empty($banner[0]['image'])) {
    $filePath = ROOT_PATH . ltrim($banner[0]['image'], '/');

    if (file_exists($filePath)) {
        unlink($filePath);
    }
}

// [3] Deletar registro do banco DEPOIS
$this-&gt;db()-&gt;delete('banners', ['id' =&gt; $id]);

// [4] Logger com snapshot (incluindo path do arquivo deletado)
Logger::getInstance()-&gt;audit('DELETE_BANNER', $this-&gt;getUser()['id'], [
    'banner_id' =&gt; $id,
    'title' =&gt; $banner[0]['title'],
    'image_path' =&gt; $banner[0]['image'],  // ‚Üê IMPORTANTE para auditoria
    'table' =&gt; 'banners'
]);
</code></pre>

<hr />

<h3 id="‚õîcheckpointobrigat√ìrio-uploaddearquivos">‚õî CHECKPOINT OBRIGAT√ìRIO - UPLOAD DE ARQUIVOS</h3>

<p><strong>N√ÉO PROSSIGA SEM COMPLETAR TODOS OS CHECKS:</strong></p>

<pre><code>üîí SEGURAN√áA:
[ ] Valida√ß√£o de tamanho implementada? (max 5MB)
[ ] Valida√ß√£o de MIME type implementada? (finfo_file)
[ ] Valida√ß√£o de extens√£o implementada? (dupla prote√ß√£o)
[ ] Nome gerado com UUID + timestamp? (NUNCA nome original)
[ ] Permiss√µes 0644 aplicadas? (chmod ap√≥s move_uploaded_file)

üìÅ ESTRUTURA:
[ ] Diret√≥rio: /storage/uploads/[recurso]/?
[ ] Diret√≥rio criado se n√£o existir? (mkdir 0755)
[ ] Verifica√ß√£o de is_writable()?

üíæ BANCO DE DADOS:
[ ] Salvando PATH relativo (n√£o absoluto)?
[ ] Coluna VARCHAR(255) ou TEXT?
[ ] Path come√ßa com /storage/uploads/?

üóëÔ∏è LIMPEZA:
[ ] UPDATE deleta arquivo antigo se novo for enviado?
[ ] DELETE deleta arquivo f√≠sico + registro?
[ ] Logger de DELETE tem path do arquivo?

‚ö†Ô∏è SE ALGUM CHECK FALHOU, VOLTE E CORRIJA AGORA!
‚ö†Ô∏è UPLOAD SEM VALIDA√á√ÉO = VULNERABILIDADE CR√çTICA!
</code></pre>

<hr />

<h3 id="üìãc√≥digocompletodeexemplo">üìã C√≥digo Completo de Exemplo</h3>

<pre><code class="php">// PASSO 4B: Upload de imagem em store()
public function store() {
    $this-&gt;requireAuth();

    try {
        // [1] CSRF
        $this-&gt;validateCSRF();

        // [2] Rate Limiting
        $ip = $_SERVER['REMOTE_ADDR'];
        if (!RateLimiter::check('banner_create', $ip, 5, 60)) {
            http_response_code(429);
            die('Muitas requisi√ß√µes');
        }

        // [3] Sanitiza√ß√£o
        $title = Security::sanitize($_POST['title'] ?? '');

        // [4] UPLOAD DE ARQUIVO
        if (empty($_FILES['image']) || $_FILES['image']['error'] !== UPLOAD_ERR_OK) {
            throw new Exception('Imagem obrigat√≥ria');
        }

        // Validar tamanho (5MB)
        if ($_FILES['image']['size'] &gt; 5 * 1024 * 1024) {
            throw new Exception('Imagem muito grande. M√°ximo: 5MB');
        }

        // Validar MIME
        $finfo = finfo_open(FILEINFO_MIME_TYPE);
        $mimeType = finfo_file($finfo, $_FILES['image']['tmp_name']);
        finfo_close($finfo);

        $allowedMimes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
        if (!in_array($mimeType, $allowedMimes)) {
            throw new Exception('Tipo de arquivo n√£o permitido');
        }

        // Validar extens√£o
        $extension = strtolower(pathinfo($_FILES['image']['name'], PATHINFO_EXTENSION));
        $allowedExtensions = ['jpg', 'jpeg', 'png', 'gif', 'webp'];
        if (!in_array($extension, $allowedExtensions)) {
            throw new Exception('Extens√£o n√£o permitida');
        }

        // Criar diret√≥rio se n√£o existir
        $uploadDir = ROOT_PATH . 'storage/uploads/banners/';
        if (!is_dir($uploadDir)) {
            mkdir($uploadDir, 0755, true);
        }

        // Gerar nome √∫nico
        $fileId = Security::generateUUID();
        $fileName = $fileId . '_' . time() . '.' . $extension;
        $filePath = $uploadDir . $fileName;

        // Mover arquivo
        if (!move_uploaded_file($_FILES['image']['tmp_name'], $filePath)) {
            throw new Exception('Erro ao salvar arquivo');
        }

        // Permiss√µes
        chmod($filePath, 0644);

        // Path relativo para o banco
        $relativeFilePath = '/storage/uploads/banners/' . $fileName;

        // [5] Valida√ß√µes de campos
        if (empty($title)) {
            throw new Exception('T√≠tulo obrigat√≥rio');
        }

        // [6] CREATE
        $id = Security::generateUUID();
        $this-&gt;db()-&gt;insert('banners', [
            'id' =&gt; $id,
            'title' =&gt; $title,
            'image' =&gt; $relativeFilePath,
            'created_at' =&gt; date('Y-m-d H:i:s')
        ]);

        // [7] Audit Log
        Logger::getInstance()-&gt;audit('CREATE_BANNER', $this-&gt;getUser()['id'], [
            'banner_id' =&gt; $id,
            'title' =&gt; $title,
            'image_path' =&gt; $relativeFilePath,
            'table' =&gt; 'banners'
        ]);

        // [8] Rate Limit Increment
        RateLimiter::increment('banner_create', $ip, 60);

        // [9] Feedback
        $this-&gt;success('Banner criado!');
        $this-&gt;redirect('/admin/banners');

    } catch (Exception $e) {
        Logger::getInstance()-&gt;warning('CREATE_BANNER_FAILED', [
            'reason' =&gt; $e-&gt;getMessage(),
            'user_id' =&gt; $this-&gt;getUser()['id']
        ]);
        $this-&gt;error($e-&gt;getMessage());
        $this-&gt;redirect('/admin/banners/create');
    }
}
</code></pre>

<hr />

<h3 id="‚úÖuploadimplementado">‚úÖ Upload Implementado</h3>

<p><strong>Se voc√™ completou este PASSO 4B:</strong></p>

<ul>
<li>‚úÖ Upload seguro implementado</li>
<li>‚úÖ Valida√ß√µes de MIME + extens√£o + tamanho</li>
<li>‚úÖ Arquivo salvo em <code>/storage/uploads/[recurso]/</code></li>
<li>‚úÖ Path relativo salvo no banco</li>
<li>‚úÖ Permiss√µes corretas (0644)</li>
</ul>

<p><strong>Pr√≥ximo:</strong> Continue para PASSO 4 item [4] VALIDA√á√ïES</p>

<hr />

<h4 id="4valida√á√ïes-emsequ√äncia">[4] VALIDA√á√ïES - EM SEQU√äNCIA</h4>

<pre><code>[ ] Campos obrigat√≥rios
  - if (empty($name)) throw new Exception('...')
  - Fazer para CADA campo obrigat√≥rio

[ ] Email (se houver campo email)
  - Security::validateEmail($email)
  - Verificar unicidade: $db-&gt;select('table', ['email' =&gt; $email])

[ ] Senha (se houver campo password)
  - Security::validatePasswordStrength($password)
  - M√≠nimo 8 caracteres, mai√∫scula, min√∫scula, n√∫mero, especial

[ ] UUID (se houver IDs relacionados)
  - Security::isValidUUID($categoryId)
  - Verificar exist√™ncia: $db-&gt;select('categories', ['id' =&gt; $categoryId])

[ ] Strings (tamanho)
  - strlen($name) &gt;= 3 &amp;&amp; strlen($name) &lt;= 255

[ ] Slug (se houver)
  - preg_match('/^[a-z0-9-]+$/', $slug)
  - Verificar unicidade: $db-&gt;select('table', ['slug' =&gt; $slug])

[ ] Arrays (se houver multi-select)
  - is_array($items)
  - Filtrar cada elemento: Security::isValidUUID($id)
  - Verificar quantity: count($items) &gt; 0
</code></pre>

<h4 id="5create-inserirnobd">[5] CREATE - INSERIR NO BD</h4>

<pre><code>[ ] Gerar UUID para novo ID
  - $id = Security::generateUUID()

[ ] Preparar dados (apenas sanitizados/validados)
  - $data = ['id' =&gt; $id, 'name' =&gt; $name, 'email' =&gt; $email, ...]

[ ] Inserir com prepared statements
  - $db-&gt;insert('table', $data)
  - OU $db-&gt;query(&quot;INSERT INTO ... VALUES (...)&quot;, [$bindings])

[ ] Sem concatena√ß√£o de strings em SQL
</code></pre>

<h4 id="6auditlog-logoap√ìscreate">[6] AUDIT LOG - LOGO AP√ìS CREATE</h4>

<pre><code>[ ] Logger::getInstance()-&gt;audit() adicionado
  - Nome de a√ß√£o: CREATE_RECURSO (mai√∫sculas, singular)
  - Exemplo: CREATE_CATEGORY, CREATE_MEMBER, CREATE_POST

[ ] Par√¢metros corretos:
  Logger::getInstance()-&gt;audit('CREATE_CATEGORY', Auth::userId(), [
    'category_id' =&gt; $categoryId,
    'name' =&gt; $name,
    'table' =&gt; 'categories'
  ]);

[ ] Campos obrigat√≥rios presentes:
  - resource_id ‚úì
  - table ‚úì
  - contexto relevante (name, email, etc) ‚úì

[ ] user_id e ip s√£o autom√°ticos (Logger adiciona)
</code></pre>

<p><strong>‚õî CHECKPOINT OBRIGAT√ìRIO - N√ÉO PROSSIGA SEM COMPLETAR:</strong></p>

<pre><code class="php">// ‚úÖ CORRETO - Logger completo
$id = Security::generateUUID();
$this-&gt;db()-&gt;insert('banners', ['id' =&gt; $id, 'title' =&gt; $title]);

Logger::getInstance()-&gt;audit('CREATE_BANNER', $this-&gt;getUser()['id'], [
    'banner_id' =&gt; $id,  // ‚Üê resource_id
    'title' =&gt; $title,    // ‚Üê contexto
    'table' =&gt; 'banners'  // ‚Üê OBRIGAT√ìRIO
]);

// ‚ùå ERRADO - esqueceu Logger
$this-&gt;db()-&gt;insert('banners', ['id' =&gt; $id, 'title' =&gt; $title]);
// NADA AQUI ‚Üê 15% DE CHANCE DESSE ERRO!
</code></pre>

<p><strong>CHECKLIST DE AUDITORIA (15% de chance de erro - VERIFICAR AGORA):</strong></p>

<pre><code>[ ] Logger::getInstance()-&gt;audit() existe DEPOIS do insert?
[ ] Nome: CREATE_[RECURSO] (mai√∫sculas, singular)?
[ ] Par√¢metro 1: user_id correto?
[ ] Array tem 'resource_id' (banner_id, category_id, etc)?
[ ] Array tem 'table' com nome da tabela?
[ ] Array tem contexto relevante (title, name, etc)?

‚ö†Ô∏è SE LOGGER N√ÉO EXISTE, VOLTE E ADICIONE AGORA!
‚ö†Ô∏è SEM LOGGER = SEM AUDITORIA = SISTEMA CEGO!
</code></pre>

<h4 id="7incrementratelimit-ap√ìslog">[7] INCREMENT RATE LIMIT - AP√ìS LOG</h4>

<pre><code>[ ] C√≥digo adicionado:
  - RateLimiter::increment('recurso_create', $ip, 60)

[ ] Localiza√ß√£o: AP√ìS db-&gt;insert() bem-sucedido
</code></pre>

<h4 id="8feedbackredirect">[8] FEEDBACK &amp; REDIRECT</h4>

<pre><code>[ ] Mensagem de sucesso
  - Admin/Module: $this-&gt;success() ou $_SESSION['success']
  - API: json(201, ['success' =&gt; true, 'data' =&gt; ...])

[ ] Redirect/Response
  - Admin/Module: $this-&gt;redirect() ou Core::redirect()
  - API: return $this-&gt;json(201, [...]) e exit
</code></pre>

<h4 id="9exceptionhandling">[9] EXCEPTION HANDLING</h4>

<pre><code>[ ] catch (Exception $e) adicionado

[ ] Logger::getInstance()-&gt;warning() para falha
  Logger::getInstance()-&gt;warning('CREATE_CATEGORY_FAILED', [
    'reason' =&gt; $e-&gt;getMessage(),
    'user_id' =&gt; Auth::userId()
  ]);

[ ] Feedback de erro
  - Admin/Module: $this-&gt;error() ou $_SESSION['error']
  - API: json(400, ['success' =&gt; false, 'error' =&gt; $e-&gt;getMessage()])

[ ] Redirect/Response apropriado
</code></pre>

<h3 id="valida√ß√£ofinaldestore">Valida√ß√£o Final de store()</h3>

<pre><code>SEGURAN√áA:
[ ] CSRF validation presente
[ ] RateLimit check + increment
[ ] Prepared statements (sem SQL injection)
[ ] Inputs sanitizados
[ ] Outputs escapados em views

AUDITORIA:
[ ] Logger::audit() presente
[ ] Nome de a√ß√£o correto (CREATE_*)
[ ] Campos: resource_id, table, contexto

VALIDA√á√ÉO:
[ ] Empty checks
[ ] Email validation + uniqueness
[ ] UUID validation + existence
[ ] String sizes
[ ] Slug (pattern + uniqueness)
</code></pre>

<p><strong>Pr√≥ximo</strong>: Passo 5</p>

<hr />

<h2 id="adminmoduleapenas">PASSO 5: IMPLEMENTAR M√âTODO edit()</h2>

<h3 id="checklistdeimplementa√ß√£o">Checklist de Implementa√ß√£o</h3>

<pre><code>[ ] Autentica√ß√£o
  - Auth::require() ou $this-&gt;requireAuth()

[ ] UUID validation do par√¢metro
  - if (!Security::isValidUUID($id)) throw/redirect

[ ] Database select
  - $record = $db-&gt;select('table', ['id' =&gt; $id])
  - if (empty($record)) throw/redirect

[ ] Dados relacionados buscados (se necess√°rio)

[ ] View renderizada com dados do registro
</code></pre>

<h3 id="valida√ß√£or√°pida">Valida√ß√£o R√°pida</h3>

<pre><code>[ ] N√£o h√° database write aqui
[ ] UUID validado
[ ] Registro verificado se existe
</code></pre>

<p><strong>Pr√≥ximo</strong>: Passo 6</p>

<hr />

<h2 id="passo6:implementarm√âtodoupdate">PASSO 6: IMPLEMENTAR M√âTODO update()</h2>

<h3 id="checklistemordemrigorosa">Checklist em Ordem Rigorosa</h3>

<p><strong>Praticamente id√™ntico ao store(), com diferen√ßas:</strong></p>

<h4 id="1csrf-primeiracoisa">[1] CSRF - PRIMEIRA COISA</h4>

<pre><code>[ ] Valida√ß√£o adicionada
</code></pre>

<h4 id="2uuidvalidation-segundacoisa">[2] UUID VALIDATION - SEGUNDA COISA</h4>

<pre><code>[ ] if (!Security::isValidUUID($id)) throw new Exception(...)
[ ] Localiza√ß√£o: ANTES de qualquer database query
</code></pre>

<h4 id="3ratelimiting">[3] RATE LIMITING</h4>

<pre><code>[ ] RateLimiter::check('recurso_update', $ip, 10, 60)
[ ] Limite um pouco mais permissivo (10 vs 5)
</code></pre>

<h4 id="4sanitiza√á√Éo">[4] SANITIZA√á√ÉO</h4>

<pre><code>[ ] Mesma coisa que em store()
</code></pre>

<h4 id="5valida√á√ïes">[5] VALIDA√á√ïES</h4>

<pre><code>[ ] Campos obrigat√≥rios: SIM
[ ] Email: 
  - Security::validateEmail()
  - Uniqueness: WHERE email = ? AND id != ? (EXCLUIR O PR√ìPRIO)
[ ] Senha: APENAS se preenchida
[ ] Strings, UUIDs, Slug: mesmo que store()
</code></pre>

<h4 id="6update-nobd">[6] UPDATE - NO BD</h4>

<pre><code>[ ] Preparar dados com APENAS campos que mudam
  - N√£o incluir 'id', 'created_at'
  - Incluir 'updated_at': date('Y-m-d H:i:s')

[ ] $db-&gt;update('table', $data, ['id' =&gt; $id])
  - OU $db-&gt;query(&quot;UPDATE table SET ... WHERE id = ?&quot;, [...])

[ ] SEM concatena√ß√£o de strings
</code></pre>

<h4 id="7auditlog">[7] AUDIT LOG</h4>

<pre><code>[ ] Logger::getInstance()-&gt;audit('UPDATE_RECURSO', Auth::userId(), [
  'resource_id' =&gt; $id,
  'fields_updated' =&gt; array_keys($data),
  'table' =&gt; 'table'
]);

[ ] Incluir QUAIS campos foram alterados (array de chaves)
</code></pre>

<h4 id="8incrementratelimit">[8] INCREMENT RATE LIMIT</h4>

<pre><code>[ ] RateLimiter::increment('recurso_update', $ip, 60)
</code></pre>

<h4 id="9feedbackredirect">[9] FEEDBACK &amp; REDIRECT</h4>

<pre><code>[ ] Sucesso com mensagem
[ ] Erro com mensagem e redirect de volta
</code></pre>

<h3 id="valida√ß√£ofinaldeupdate">Valida√ß√£o Final de update()</h3>

<pre><code>SEGURAN√áA:
[ ] CSRF validation
[ ] UUID validation
[ ] RateLimit check + increment
[ ] Prepared statements
[ ] Email uniqueness exclui pr√≥prio (id != ?)
[ ] Senha validada apenas se preenchida

AUDITORIA:
[ ] Logger::audit('UPDATE_*')
[ ] Campos alterados inclusos

VALIDA√á√ÉO:
[ ] Todos os checks como em store()
</code></pre>

<p><strong>Pr√≥ximo</strong>: Passo 7</p>

<hr />

<h2 id="delete">PASSO 7: IMPLEMENTAR M√âTODO destroy()</h2>

<h3 id="checklistemordemrigorosa">Checklist em Ordem Rigorosa</h3>

<h4 id="1csrf-primeiracoisa">[1] CSRF - PRIMEIRA COISA</h4>

<pre><code>[ ] Valida√ß√£o adicionada
</code></pre>

<h4 id="2uuidvalidation">[2] UUID VALIDATION</h4>

<pre><code>[ ] if (!Security::isValidUUID($id)) throw/redirect
</code></pre>

<h4 id="3ratelimiting">[3] RATE LIMITING</h4>

<pre><code>[ ] RateLimiter::check('recurso_delete', $ip, 5, 60)
</code></pre>

<h4 id="4selectvalidateexistence">[4] SELECT &amp; VALIDATE EXISTENCE</h4>

<pre><code>[ ] $record = $db-&gt;select('table', ['id' =&gt; $id])
[ ] if (empty($record)) throw/redirect
[ ] ‚ö†Ô∏è IMPORTANTE: guardar $record para audit log depois
</code></pre>

<h4 id="5valida√á√ïesadicionaissehouver">[5] VALIDA√á√ïES ADICIONAIS (se houver)</h4>

<pre><code>[ ] N√£o pode deletar admin principal?
[ ] N√£o pode deletar se tem relacionamentos?
[ ] Adicionar checks espec√≠ficos do recurso
</code></pre>

<h4 id="6delete-nobd">[6] DELETE - NO BD</h4>

<pre><code>[ ] $db-&gt;delete('table', ['id' =&gt; $id])
  - OU $db-&gt;query(&quot;DELETE FROM table WHERE id = ?&quot;, [$id])

[ ] SEM concatena√ß√£o de strings
</code></pre>

<h4 id="7auditlog-comsnapshot">[7] AUDIT LOG - COM SNAPSHOT</h4>

<pre><code>[ ] Logger::getInstance()-&gt;audit('DELETE_RECURSO', Auth::userId(), [
  'resource_id' =&gt; $id,
  'name' =&gt; $record['name'],        ‚Üê dados antes de deletar
  'email' =&gt; $record['email'],      ‚Üê snapshot completo
  'table' =&gt; 'table'
]);

[ ] MUITO IMPORTANTE: incluir dados do registro deletado
   (para poder recuperar/auditar depois)
</code></pre>

<h4 id="8incrementratelimit">[8] INCREMENT RATE LIMIT</h4>

<pre><code>[ ] RateLimiter::increment('recurso_delete', $ip, 60)
</code></pre>

<h4 id="9feedbackredirect">[9] FEEDBACK &amp; REDIRECT</h4>

<pre><code>[ ] Sucesso com mensagem
[ ] Erro com mensagem
</code></pre>

<h3 id="valida√ß√£ofinaldedestroy">Valida√ß√£o Final de destroy()</h3>

<pre><code>SEGURAN√áA:
[ ] CSRF validation
[ ] UUID validation
[ ] RateLimit check + increment
[ ] Prepared statements

AUDITORIA:
[ ] Logger::audit('DELETE_*')
[ ] Snapshot de dados do registro deletado

VALIDA√á√ÉO:
[ ] UUID validado
[ ] Registro verificado se existe
</code></pre>

<p><strong>Pr√≥ximo</strong>: Passo 8</p>

<hr />

<h2 id="passo8a:criarviewsadmincrud">PASSO 8A: CRIAR VIEWS (Admin CRUD)</h2>

<h3 id="üìãusartemplatesprontosrecomendado">üìã Usar Templates Prontos (RECOMENDADO)</h3>

<p><strong>AEGIS possui templates prontos com padr√£o correto:</strong></p>

<p><strong>Localiza√ß√£o:</strong> <code>/docs/crud/templates/views/</code></p>

<pre><code>index.template.php   ‚Üí Listagem com tabela
create.template.php  ‚Üí Formul√°rio de cria√ß√£o
edit.template.php    ‚Üí Formul√°rio de edi√ß√£o
</code></pre>

<p><strong>Como usar:</strong></p>

<ol>
<li><strong>Copiar template para seu CRUD:</strong></li>
</ol>

<pre><code class="bash">cp docs/crud/templates/views/index.template.php admin/views/banners/index.php
cp docs/crud/templates/views/create.template.php admin/views/banners/create.php
cp docs/crud/templates/views/edit.template.php admin/views/banners/edit.php
</code></pre>

<ol>
<li><strong>Substituir placeholders:</strong></li>
</ol>

<pre><code>{{RESOURCE_PLURAL}} ‚Üí &quot;Banners Hero&quot;
{{RESOURCE_SINGULAR}} ‚Üí &quot;Banner&quot;
{{resource_slug}} ‚Üí &quot;banners&quot;
{{resource_var_plural}} ‚Üí $banners
{{resource_var_singular}} ‚Üí $banner
</code></pre>

<ol>
<li><strong>Personalizar campos:</strong></li>
</ol>

<ul>
<li>Ajustar colunas da tabela (index.php)</li>
<li>Ajustar campos do formul√°rio (create.php, edit.php)</li>
<li>Remover campos de exemplo n√£o necess√°rios</li>
</ul>

<p><strong>‚úÖ Vantagens dos templates:</strong></p>

<ul>
<li>Padr√£o AEGIS j√° aplicado (classes corretas)</li>
<li>√çcones Lucide inclu√≠dos</li>
<li>Alerts configurados</li>
<li>CSRF token inclu√≠do</li>
<li>Instru√ß√µes de uso no final do arquivo</li>
<li>Exemplos de todos os tipos de campo</li>
</ul>

<p><strong>üìö Cada template tem instru√ß√µes completas no final do arquivo!</strong></p>

<hr />

<h3 id="admincontrollersusamsemprethis-render">Admin Controllers Usam Sempre <code>$this-&gt;render()</code></h3>

<p><strong>Para Admin CRUD, SEMPRE use:</strong></p>

<pre><code class="php">$this-&gt;render('banners/index', ['data' =&gt; $data]);
// Procura em: ROOT_PATH . 'admin/views/banners/index.php'
</code></pre>

<h3 id="checklistderenderiza√ß√£o">Checklist de Renderiza√ß√£o</h3>

<pre><code>[ ] Admin controller ‚Üí usar $this-&gt;render()

[ ] Path da view correto:
    - render('banners/index') ‚Üí /admin/views/banners/index.php

[ ] Diret√≥rio da view existe?
    mkdir -p /admin/views/banners

[ ] Arquivo .php criado com nome correto (min√∫sculo)
    index.php (n√£o Index.php)
</code></pre>

<h3 id="‚ö†Ô∏ècr√çtico:permiss√µesdearquivo">‚ö†Ô∏è CR√çTICO: Permiss√µes de Arquivo</h3>

<p><strong>Se criar view com permiss√µes erradas, Apache N√ÉO consegue ler ‚Üí ERROR 500 silencioso</strong></p>

<p><strong>Sempre que criar arquivo de view:</strong></p>

<pre><code class="bash">chmod 644 /admin/views/banners/index.php
</code></pre>

<p><strong>Permiss√µes corretas:</strong></p>

<ul>
<li><code>644</code> = owner read+write, group read, others read</li>
<li>Apache consegue ler ‚úÖ</li>
<li>Owner consegue editar ‚úÖ</li>
</ul>

<p><strong>Se esquecer:</strong></p>

<ul>
<li>Arquivo fica <code>600</code> (s√≥ owner consegue ler)</li>
<li>Apache n√£o consegue ler</li>
<li>Resultado: ERROR 500 &#8220;View not found&#8221; ou silencioso</li>
<li>Debug: muito dif√≠cil de encontrar</li>
</ul>

<p><strong>‚õî CHECKPOINT OBRIGAT√ìRIO - N√ÉO PROSSIGA SEM COMPLETAR:</strong></p>

<pre><code class="bash"># ‚úÖ CORRETO - chmod 644 IMEDIATAMENTE ap√≥s criar
touch /admin/views/banners/index.php
chmod 644 /admin/views/banners/index.php  # ‚Üê OBRIGAT√ìRIO

# ‚ùå ERRADO - esqueceu chmod
touch /admin/views/banners/index.php
# NADA ‚Üê 30% DE CHANCE DESSE ERRO!
# Resultado: ERROR 500 silencioso
</code></pre>

<p><strong>CHECKLIST OBRIGAT√ìRIO (30% de chance de erro - VERIFICAR AGORA):</strong></p>

<pre><code>[ ] Arquivo view criado?
[ ] CHMOD 644 executado? (USE O COMANDO AGORA)
[ ] Testado no browser: n√£o h√° erro 500?
[ ] Se erro 500, EXECUTAR: chmod 644 [arquivo]

‚ö†Ô∏è TESTE AGORA: curl http://localhost:5757/aegis/admin/banners
‚ö†Ô∏è SE DER ERRO 500, PRIMEIRA COISA: chmod 644 na view!
</code></pre>

<h3 id="estruturab√°sicadeview">Estrutura B√°sica de View</h3>

<p><strong>Exemplo: /admin/views/banners/index.php</strong></p>

<pre><code class="php">&lt;?php
// Dados passados via render()
// $banners j√° est√° dispon√≠vel aqui
?&gt;

&lt;div class=&quot;container&quot;&gt;
    &lt;div class=&quot;header&quot;&gt;
        &lt;h1&gt;Banners&lt;/h1&gt;
        &lt;a href=&quot;&lt;?= url('admin/banners/create') ?&gt;&quot; class=&quot;btn&quot;&gt;+ Novo&lt;/a&gt;
    &lt;/div&gt;

    &lt;?php if (!empty($banners)): ?&gt;
        &lt;table&gt;
            &lt;?php foreach ($banners as $banner): ?&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;?= htmlspecialchars($banner['title']) ?&gt;&lt;/td&gt;
                    &lt;td&gt;
                        &lt;a href=&quot;&lt;?= url('admin/banners/' . $banner['id'] . '/edit') ?&gt;&quot;&gt;Editar&lt;/a&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
            &lt;?php endforeach; ?&gt;
        &lt;/table&gt;
    &lt;?php else: ?&gt;
        &lt;p&gt;Nenhum banner encontrado. &lt;a href=&quot;&lt;?= url('admin/banners/create') ?&gt;&quot;&gt;Criar o primeiro?&lt;/a&gt;&lt;/p&gt;
    &lt;?php endif; ?&gt;
&lt;/div&gt;
</code></pre>

<hr />

<h3 id="exemplo:create.php">Exemplo: create.php</h3>

<pre><code class="php">&lt;?php
// Dados: $user (dispon√≠vel automaticamente)
?&gt;

&lt;div class=&quot;container&quot;&gt;
    &lt;h1&gt;Novo Banner&lt;/h1&gt;
    &lt;p&gt;&lt;a href=&quot;&lt;?= url('admin/banners') ?&gt;&quot;&gt;‚Üê Voltar&lt;/a&gt;&lt;/p&gt;

    &lt;form method=&quot;POST&quot; action=&quot;&lt;?= url('admin/banners') ?&gt;&quot; enctype=&quot;multipart/form-data&quot;&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;csrf_token&quot; value=&quot;&lt;?= Security::generateCSRF() ?&gt;&quot;&gt;

        &lt;label&gt;T√≠tulo *&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;title&quot; required maxlength=&quot;255&quot;&gt;

        &lt;label&gt;Imagem *&lt;/label&gt;
        &lt;input type=&quot;file&quot; name=&quot;image&quot; required accept=&quot;image/*&quot;&gt;

        &lt;label&gt;
            &lt;input type=&quot;checkbox&quot; name=&quot;ativo&quot; checked&gt;
            Ativo
        &lt;/label&gt;

        &lt;button type=&quot;submit&quot;&gt;Criar&lt;/button&gt;
        &lt;a href=&quot;&lt;?= url('admin/banners') ?&gt;&quot;&gt;Cancelar&lt;/a&gt;
    &lt;/form&gt;
&lt;/div&gt;
</code></pre>

<hr />

<h3 id="exemplo:edit.php">Exemplo: edit.php</h3>

<pre><code class="php">&lt;?php
// Dados: $banner, $user
?&gt;

&lt;div class=&quot;container&quot;&gt;
    &lt;h1&gt;Editar Banner&lt;/h1&gt;
    &lt;p&gt;&lt;a href=&quot;&lt;?= url('admin/banners') ?&gt;&quot;&gt;‚Üê Voltar&lt;/a&gt;&lt;/p&gt;

    &lt;form method=&quot;POST&quot; action=&quot;&lt;?= url('admin/banners/' . $banner['id']) ?&gt;&quot; enctype=&quot;multipart/form-data&quot;&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;csrf_token&quot; value=&quot;&lt;?= Security::generateCSRF() ?&gt;&quot;&gt;

        &lt;label&gt;T√≠tulo *&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;title&quot; value=&quot;&lt;?= htmlspecialchars($banner['title']) ?&gt;&quot; required&gt;

        &lt;label&gt;Imagem Atual:&lt;/label&gt;
        &lt;img src=&quot;&lt;?= htmlspecialchars($banner['image']) ?&gt;&quot; width=&quot;200&quot;&gt;

        &lt;label&gt;Nova Imagem (deixe vazio para manter)&lt;/label&gt;
        &lt;input type=&quot;file&quot; name=&quot;image&quot; accept=&quot;image/*&quot;&gt;

        &lt;label&gt;
            &lt;input type=&quot;checkbox&quot; name=&quot;ativo&quot; &lt;?= $banner['ativo'] ? 'checked' : '' ?&gt;&gt;
            Ativo
        &lt;/label&gt;

        &lt;button type=&quot;submit&quot;&gt;Salvar&lt;/button&gt;
        &lt;a href=&quot;&lt;?= url('admin/banners') ?&gt;&quot;&gt;Cancelar&lt;/a&gt;
    &lt;/form&gt;
&lt;/div&gt;
</code></pre>

<hr />

<h3 id="‚ö†Ô∏ècr√çtico:csrftoken">‚ö†Ô∏è CR√çTICO: CSRF Token</h3>

<p><strong>TODAS as views com <code>&lt;form method=&quot;POST&quot;&gt;</code> DEVEM ter:</strong></p>

<pre><code class="php">&lt;input type=&quot;hidden&quot; name=&quot;csrf_token&quot; value=&quot;&lt;?= Security::generateCSRF() ?&gt;&quot;&gt;
</code></pre>

<p><strong>‚ùå ERRADO:</strong></p>

<ul>
<li><code>Security::generateCSRFToken()</code> (m√©todo n√£o existe)</li>
<li><code>htmlspecialchars(Security::generateCSRF())</code> (desnecess√°rio)</li>
<li>Esquecer o token (form ser√° bloqueado)</li>
</ul>

<p><strong>‚úÖ CORRETO:</strong></p>

<ul>
<li><code>Security::generateCSRF()</code> (sem htmlspecialchars)</li>
</ul>

<hr />

<h3 id="erroscomuns">Erros Comuns</h3>

<table>
<colgroup>
<col />
<col />
<col />
</colgroup>

<thead>
<tr>
	<th> Erro </th>
	<th> Causa </th>
	<th> Solu√ß√£o </th>
</tr>
</thead>

<tbody>
<tr>
	<td> 500 ao acessar </td>
	<td> Permiss√£o do arquivo </td>
	<td> <code>chmod 644</code> </td>
</tr>
<tr>
	<td> 500 no create </td>
	<td> <code>generateCSRFToken()</code> errado </td>
	<td> Usar <code>generateCSRF()</code> </td>
</tr>
<tr>
	<td> &#8220;View not found&#8221; </td>
	<td> Path incorreto </td>
	<td> Verificar <code>render()</code> path </td>
</tr>
<tr>
	<td> Vari√°veis n√£o aparecem </td>
	<td> N√£o passou em <code>render()</code> </td>
	<td> Passar array <code>['banners' =&gt; $data]</code> </td>
</tr>
<tr>
	<td> XSS na p√°gina </td>
	<td> N√£o sanitizou output </td>
	<td> Sempre usar <code>htmlspecialchars()</code> </td>
</tr>
<tr>
	<td> CSRF block </td>
	<td> Token ausente/errado </td>
	<td> Adicionar <code>Security::generateCSRF()</code> </td>
</tr>
</tbody>
</table>

<hr />

<h2 id="passo8:verifica√á√Éofinal">PASSO 8: VERIFICA√á√ÉO FINAL</h2>

<h3 id="üîígatedeseguran√áa-bloqueiototalat√âcompletar">üîí GATE DE SEGURAN√áA - BLOQUEIO TOTAL AT√â COMPLETAR</h3>

<p><strong>‚õî VOC√ä N√ÉO PODE PROSSEGUIR PARA PASSO 9 AT√â COMPLETAR 100% DESTE CHECKPOINT</strong></p>

<p>Esta √© sua √∫ltima chance de evitar criar c√≥digo inseguro. <strong>SE VOC√ä PULAR ESTE PASSO, SEU CRUD ESTAR√Å VULNER√ÅVEL.</strong></p>

<hr />

<h3 id="üö®checkpoint1:seguran√áacr√çticaobrigat√ìrio">üö® CHECKPOINT 1: SEGURAN√áA CR√çTICA (OBRIGAT√ìRIO)</h3>

<p><strong>ESTES 4 CHECKS BLOQUEIAM O PROSSEGUIMENTO. N√ÉO CONTINUE SE ALGUM ESTIVER FALTANDO.</strong></p>

<pre><code>üî¥ CSRF VALIDATION (store/update/destroy):
[ ] store() tem $this-&gt;validateCSRF() como PRIMEIRA LINHA?
[ ] update() tem $this-&gt;validateCSRF() como PRIMEIRA LINHA?
[ ] destroy() tem $this-&gt;validateCSRF() como PRIMEIRA LINHA?
‚ö†Ô∏è SE ALGUM &quot;N√ÉO&quot;: PARE AGORA E ADICIONE!

üî¥ RATE LIMITING (store/update/destroy):
[ ] store() tem RateLimiter::check() ANTES de valida√ß√µes?
[ ] store() tem RateLimiter::increment() DEPOIS do insert?
[ ] update() tem check + increment?
[ ] destroy() tem check + increment?
‚ö†Ô∏è SE ALGUM &quot;N√ÉO&quot;: PARE AGORA E ADICIONE!

üî¥ AUDIT LOGGING (store/update/destroy):
[ ] store() tem Logger::audit('CREATE_*') DEPOIS do insert?
[ ] update() tem Logger::audit('UPDATE_*') DEPOIS do update?
[ ] destroy() tem Logger::audit('DELETE_*') DEPOIS do delete?
[ ] destroy() Logger tem snapshot de dados deletados?
‚ö†Ô∏è SE ALGUM &quot;N√ÉO&quot;: PARE AGORA E ADICIONE!

üî¥ SQL INJECTION PREVENTION (TODOS m√©todos):
[ ] TODAS queries usam prepared statements (?)?
[ ] NENHUMA query concatena strings com vari√°veis?
[ ] Se tem reserved keyword: TODAS ocorr√™ncias t√™m backticks?
‚ö†Ô∏è SE ALGUM &quot;N√ÉO&quot;: PARE AGORA E CORRIJA!
</code></pre>

<p><strong>‚ùå SE QUALQUER UM DOS 4 CHECKS ACIMA FALHOU: N√ÉO PROSSIGA</strong></p>

<p><strong>‚úÖ SE TODOS OS 4 CHECKS PASSARAM: CONTINUE PARA CHECKPOINT 2</strong></p>

<hr />

<h3 id="üü°checkpoint2:valida√á√ïesefeedbackobrigat√ìrio">üü° CHECKPOINT 2: VALIDA√á√ïES E FEEDBACK (OBRIGAT√ìRIO)</h3>

<pre><code>VALIDA√á√ÉO (store/update):
[ ] Empty checks para campos obrigat√≥rios?
[ ] Email: Security::validateEmail() + uniqueness?
[ ] Senha: Security::validatePasswordStrength() (create)?
[ ] Senha: validada apenas se preenchida (update)?
[ ] UUID: Security::isValidUUID() + verifica√ß√£o de exist√™ncia?
[ ] Strings: strlen() min/max verificados?
[ ] Slug: regex pattern + uniqueness?
‚ö†Ô∏è SE ALGUM &quot;N√ÉO&quot;: CORRIJA ANTES DE PROSSEGUIR!

FEEDBACK E EXCEPTION HANDLING:
[ ] Todos m√©todos t√™m try/catch?
[ ] catch tem Logger::warning('[ACTION]_FAILED')?
[ ] Sucesso tem mensagem clara?
[ ] Erro tem mensagem clara?
[ ] Redirect/Response apropriado?
‚ö†Ô∏è SE ALGUM &quot;N√ÉO&quot;: ADICIONE ANTES DE PROSSEGUIR!
</code></pre>

<p><strong>‚ùå SE CHECKPOINT 2 FALHOU: N√ÉO PROSSIGA</strong></p>

<p><strong>‚úÖ SE CHECKPOINT 2 PASSOU: CONTINUE PARA CHECKPOINT 3</strong></p>

<hr />

<h3 id="üü¢checkpoint3:estruturaenomenclaturaobrigat√ìrio">üü¢ CHECKPOINT 3: ESTRUTURA E NOMENCLATURA (OBRIGAT√ìRIO)</h3>

<pre><code>ESTRUTURA GERAL:
[ ] Arquivo tem EXATAMENTE 6 m√©todos (index, create, store, edit, update, destroy)?
[ ] Heran√ßa correta (BaseController)?
[ ] Auth presente em TODOS m√©todos?
[ ] Nenhuma fun√ß√£o duplicada?

NOMENCLATURA CONSISTENTE:
[ ] Logger actions: CREATE_[RECURSO], UPDATE_[RECURSO], DELETE_[RECURSO]?
[ ] RateLimiter keys: recurso_create, recurso_update, recurso_delete?
[ ] Tudo em MAI√öSCULAS e SINGULAR?
‚ö†Ô∏è SE ALGUM &quot;N√ÉO&quot;: CORRIJA AGORA!
</code></pre>

<p><strong>‚ùå SE CHECKPOINT 3 FALHOU: N√ÉO PROSSIGA</strong></p>

<p><strong>‚úÖ SE CHECKPOINT 3 PASSOU: VOC√ä EST√Å LIBERADO PARA PASSO 9</strong></p>

<hr />

<h3 id="‚úÖaprova√á√Éofinal">‚úÖ APROVA√á√ÉO FINAL</h3>

<p><strong>SE VOC√ä CHEGOU AQUI E TODOS OS 3 CHECKPOINTS PASSARAM:</strong></p>

<pre><code>üéâ SEU CONTROLLER EST√Å SEGURO E COMPLETO!
üëâ PODE PROSSEGUIR PARA PASSO 9 (Adicionar Routes)
</code></pre>

<p><strong>SE ALGUM CHECKPOINT FALHOU:</strong></p>

<pre><code>‚õî VOLTE E CORRIJA OS ERROS IMEDIATAMENTE
‚õî N√ÉO TENTE CONTINUAR SEM 100% DOS CHECKS
‚õî C√ìDIGO INCOMPLETO = VULNERABILIDADES = ATAQUE
</code></pre>

<h3 id="tester√°pidoopcional">Teste R√°pido (Opcional)</h3>

<pre><code>[ ] Abra arquivo no editor
[ ] Procure por: 
  - &quot;validateCSRF&quot; ‚Üí deve estar em store/update/destroy
  - &quot;RateLimiter&quot; ‚Üí deve estar em store/update/destroy
  - &quot;Logger::audit&quot; ‚Üí deve estar em store/update/destroy
  - &quot;SELECT&quot; ‚Üí deve ter ? ou prepared statement

[ ] Se faltar algo: volte ao passo correspondente
</code></pre>

<hr />

<h2 id="passo9:adicionarroutes">PASSO 9: ADICIONAR ROUTES</h2>

<h3 id="ondeadicionarasrotas">Onde Adicionar as Rotas</h3>

<p><strong>Se for ADMIN CRUD:</strong></p>

<ul>
<li>Arquivo: <code>/routes/admin.php</code></li>
<li>Prefixo: <code>/admin/</code></li>
</ul>

<p><strong>Se for FRONTEND/PUBLIC:</strong></p>

<ul>
<li>Arquivo: <code>/routes/public.php</code></li>
<li>Prefixo: <code>/</code> (nenhum)</li>
</ul>

<p><strong>Se for API:</strong></p>

<ul>
<li>Arquivo: <code>/routes/api.php</code></li>
<li>Prefixo: <code>/api/v1/</code> (versionado)</li>
</ul>

<h3 id="padr√£odeurlsrest">Padr√£o de URLs REST</h3>

<p><strong>Para recurso &#8220;banners&#8221; (exemplo):</strong></p>

<pre><code class="php">// INDEX - Listar todos
GET /admin/banners

// CREATE - Formul√°rio criar
GET /admin/banners/create

// STORE - Salvar novo
POST /admin/banners

// EDIT - Formul√°rio editar
GET /admin/banners/:id/edit

// UPDATE - Salvar edi√ß√£o
POST /admin/banners/:id

// DESTROY - Deletar
POST /admin/banners/:id/delete
</code></pre>

<h3 id="implementa√ß√£ocompletaderoutes">Implementa√ß√£o Completa de Routes</h3>

<p><strong>Adicione em <code>/routes/admin.php</code> (ou public.php):</strong></p>

<pre><code class="php">// ================================================
// BANNERS - Carrossel de banners rotativos
// ================================================

// INDEX: Listar banners
Router::get('/admin/banners', function() {
    $controller = new BannerController();
    $controller-&gt;index();
});

// CREATE: Exibir formul√°rio criar
Router::get('/admin/banners/create', function() {
    $controller = new BannerController();
    $controller-&gt;create();
});

// STORE: Processar cria√ß√£o
Router::post('/admin/banners', function() {
    $controller = new BannerController();
    $controller-&gt;store();
});

// EDIT: Exibir formul√°rio editar
Router::get('/admin/banners/:id/edit', function($id) {
    $controller = new BannerController();
    $controller-&gt;edit($id);
});

// UPDATE: Processar edi√ß√£o
Router::post('/admin/banners/:id', function($id) {
    $controller = new BannerController();
    $controller-&gt;update($id);
});

// DESTROY: Processar dele√ß√£o
Router::post('/admin/banners/:id/delete', function($id) {
    $controller = new BannerController();
    $controller-&gt;destroy($id);
});
</code></pre>

<h3 id="checklistderoutes">Checklist de Routes</h3>

<pre><code>[ ] Arquivo correto (admin.php ou public.php ou api.php)
[ ] 6 rotas adicionadas (index, create, store, edit, update, destroy)
[ ] GET para pages (index, create, edit)
[ ] POST para actions (store, update, destroy)
[ ] :id com parametro em URL (edit, update, destroy)
[ ] Fun√ß√£o lambda chama controller correto
[ ] Parametro $id passado onde necess√°rio (edit, update, destroy)
[ ] Nomes de URL consistentes e em ingl√™s
[ ] Prefixo correto (/admin/, /public/, /api/)
</code></pre>

<h3 id="exemplosreais">Exemplos Reais</h3>

<p><strong>ADMIN CRUD (ex: Categories)</strong></p>

<pre><code class="php">Router::get('/admin/categories', function() { ... });
Router::get('/admin/categories/create', function() { ... });
Router::post('/admin/categories', function() { ... });
Router::get('/admin/categories/:id/edit', function($id) { ... });
Router::post('/admin/categories/:id', function($id) { ... });
Router::post('/admin/categories/:id/delete', function($id) { ... });
</code></pre>

<p><strong>PUBLIC RESOURCE (ex: Blog posts)</strong></p>

<pre><code class="php">Router::get('/posts', function() { ... });
Router::get('/posts/:slug', function($slug) { ... });
</code></pre>

<p><strong>API (ex: Users)</strong></p>

<pre><code class="php">Router::get('/api/v1/users', function() { ... });
Router::post('/api/v1/users', function() { ... });
Router::get('/api/v1/users/:id', function($id) { ... });
Router::put('/api/v1/users/:id', function($id) { ... });
Router::delete('/api/v1/users/:id', function($id) { ... });
</code></pre>

<hr />

<h2 id="passo10:adicionarroutes">PASSO 10: ADICIONAR ROUTES</h2>

<p>J√° coberto no Passo 9 acima.</p>

<hr />

<h2 id="passo11:seuadmincrudest√Åprontoüéâ">PASSO 11: SEU ADMIN CRUD EST√Å PRONTO! üéâ</h2>

<h3 id="‚úÖparab√©nsvoc√™completouoadmincrud">‚úÖ Parab√©ns! Voc√™ Completou o Admin CRUD</h3>

<p><strong>Neste ponto, voc√™ tem:</strong></p>

<ul>
<li>‚úÖ Controller Admin completo em <code>/admin/controllers/</code></li>
<li>‚úÖ 6 m√©todos funcionando (index, create, store, edit, update, destroy)</li>
<li>‚úÖ Views Admin em <code>/admin/views/</code></li>
<li>‚úÖ Rotas em <code>/routes/admin.php</code></li>
<li>‚úÖ CRUD 100% funcional</li>
</ul>

<p><strong>Seu Admin CRUD est√° COMPLETO e PRONTO para uso.</strong></p>

<hr />

<h3 id="ü§îquerexibirdadosemfrontend">ü§î Quer Exibir Dados em Frontend?</h3>

<p><strong>Se voc√™ quer exibir os dados do Admin CRUD em alguma p√°gina frontend (home, blog, sidebar, etc):</strong></p>

<p>üëâ <strong>V√° para PASSO 11B</strong> (opcional, logo abaixo)</p>

<p><strong>Caso contr√°rio:</strong></p>

<p>üëâ <strong>V√° para PASSO 12</strong> (entregar)</p>

<hr />

<h2 id="passo11b:criardisplayfrontendopcional">PASSO 11B: CRIAR DISPLAY FRONTEND (OPCIONAL)</h2>

<h3 id="‚ö†Ô∏èimportante:seuadmincrudj√°est√°completo">‚ö†Ô∏è IMPORTANTE: Seu Admin CRUD J√° Est√° Completo</h3>

<p><strong>Este passo √© APENAS se voc√™ quer exibir os dados em alguma p√°gina frontend (home, blog, sidebar, etc).</strong></p>

<p><strong>Se n√£o quiser integra√ß√£o frontend, seu CRUD est√° 100% pronto. V√° para PASSO 12.</strong></p>

<hr />

<h3 id="üìãnovaabordagem:partialreutiliz√°velpreviewnoadmin">üìã Nova Abordagem: Partial Reutiliz√°vel + Preview no Admin</h3>

<p><strong>Ao inv√©s de perguntar &#8220;onde vai exibir?&#8221;, criamos:</strong></p>

<ol>
<li>Controller frontend gen√©rico (read-only)</li>
<li>Partial reutiliz√°vel que pode ser inclu√≠da em qualquer lugar</li>
<li>Preview no admin mostrando como ficou + c√≥digo para copiar</li>
</ol>

<p><strong>Vantagens:</strong></p>

<ul>
<li>‚úÖ C√≥digo reutiliz√°vel (usar em m√∫ltiplas p√°ginas)</li>
<li>‚úÖ Preview direto no admin (feedback visual)</li>
<li>‚úÖ C√≥digo pronto para copiar (facilita implementa√ß√£o)</li>
<li>‚úÖ Sem acoplamento (n√£o precisa definir p√°gina espec√≠fica)</li>
</ul>

<hr />

<h3 id="passo11b.1:criarcontrollerfrontend">PASSO 11B.1: Criar Controller Frontend</h3>

<p><strong>Arquivo: <code>/frontend/controllers/Frontend[Recurso]Controller.php</code></strong></p>

<p><strong>Exemplo: <code>FrontendBannerController.php</code></strong></p>

<pre><code class="php">&lt;?php
/**
 * FrontendBannerController
 * Busca dados para exibi√ß√£o frontend (read-only)
 */

class FrontendBannerController extends BaseController {

    /**
     * Buscar registros ativos para exibi√ß√£o
     * @return array Registros ativos ordenados
     */
    public function getActive() {
        try {
            $data = $this-&gt;db()-&gt;query(
                &quot;SELECT * FROM [tabela] WHERE ativo = 1 ORDER BY `order` ASC&quot;
            );

            return $data ?? [];

        } catch (Exception $e) {
            error_log('Frontend[Recurso]Controller::getActive() ERROR: ' . $e-&gt;getMessage());
            return [];
        }
    }
}
</code></pre>

<p><strong>Checklist:</strong></p>

<pre><code>[ ] Arquivo em /frontend/controllers/
[ ] Nome: Frontend[Recurso]Controller
[ ] M√©todo getActive() retorna array
[ ] Query busca apenas ativo = 1
[ ] Error handling sem expor erro ao p√∫blico
[ ] chmod 644
</code></pre>

<hr />

<h3 id="passo11b.2:criarpartialfrontend">PASSO 11B.2: Criar Partial Frontend</h3>

<p><strong>Arquivo: <code>/frontend/views/partials/[recurso]-display.php</code></strong></p>

<p><strong>Exemplo: <code>banner-hero.php</code> (carrossel)</strong></p>

<pre><code class="php">&lt;?php
/**
 * Partial: Banner Hero
 * Pode ser inclu√≠do em qualquer p√°gina
 */

// Buscar banners ativos
$controller = new FrontendBannerController();
$banners = $controller-&gt;getActive();

// Se n√£o houver dados, n√£o renderizar
if (empty($banners)) {
    return;
}
?&gt;

&lt;section class=&quot;hero-carousel&quot;&gt;
    &lt;?php foreach ($banners as $item): ?&gt;
        &lt;div class=&quot;slide&quot;&gt;
            &lt;h1&gt;&lt;?= htmlspecialchars($item['title']) ?&gt;&lt;/h1&gt;
            &lt;!-- Estrutura HTML aqui --&gt;
        &lt;/div&gt;
    &lt;?php endforeach; ?&gt;
&lt;/section&gt;

&lt;style&gt;
/* CSS inline ou refer√™ncia externa */
&lt;/style&gt;

&lt;script&gt;
// JavaScript se necess√°rio
&lt;/script&gt;
</code></pre>

<p><strong>Checklist:</strong></p>

<pre><code>[ ] Arquivo em /frontend/views/partials/
[ ] Nome: [recurso]-display.php
[ ] Instancia Frontend[Recurso]Controller
[ ] Chama getActive()
[ ] Return early se vazio
[ ] htmlspecialchars() em TODAS as sa√≠das
[ ] chmod 644
</code></pre>

<hr />

<h3 id="passo11b.3:adicionarpreviewnoadmin">PASSO 11B.3: Adicionar Preview no Admin</h3>

<p><strong>Editar: <code>/admin/views/[recurso]/index.php</code></strong></p>

<p><strong>Adicionar ANTES do <code>&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code> final:</strong></p>

<pre><code class="php">        &lt;!-- Preview Frontend --&gt;
        &lt;?php if (!empty($[recurso]s)): ?&gt;
            &lt;hr style=&quot;margin: 40px 0; border: none; border-top: 2px solid #ddd;&quot;&gt;

            &lt;div style=&quot;margin-bottom: 20px;&quot;&gt;
                &lt;h2 style=&quot;margin-bottom: 10px;&quot;&gt;Preview Frontend&lt;/h2&gt;
                &lt;p style=&quot;color: #6c757d; font-size: 14px;&quot;&gt;
                    Veja como os registros ativos aparecem no site
                &lt;/p&gt;

                &lt;!-- C√≥digo para copiar --&gt;
                &lt;div style=&quot;background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 4px; margin-top: 15px; font-family: 'Courier New', monospace; font-size: 13px;&quot;&gt;
                    &lt;div style=&quot;display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;&quot;&gt;
                        &lt;strong style=&quot;color: #f8f8f2;&quot;&gt;Incluir em qualquer p√°gina:&lt;/strong&gt;
                        &lt;button onclick=&quot;copyCode()&quot; style=&quot;background: #44475a; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 11px;&quot;&gt;
                            üìã Copiar
                        &lt;/button&gt;
                    &lt;/div&gt;
                    &lt;code id=&quot;include-code&quot; style=&quot;display: block;&quot;&gt;&amp;lt;?php Core::requireInclude('frontend/views/partials/[recurso]-display.php', true); ?&amp;gt;&lt;/code&gt;
                &lt;/div&gt;

                &lt;script&gt;
                function copyCode() {
                    const code = document.getElementById('include-code').textContent;
                    navigator.clipboard.writeText(code).then(() =&gt; alert('C√≥digo copiado!'));
                }
                &lt;/script&gt;
            &lt;/div&gt;

            &lt;?php
            // Filtrar apenas ativos para preview
            $ativos = array_filter($[recurso]s, function($item) {
                return $item['ativo'] == 1;
            });

            if (!empty($ativos)):
            ?&gt;
                &lt;div style=&quot;background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;&quot;&gt;
                    &lt;?php Core::requireInclude('frontend/views/partials/[recurso]-display.php', true); ?&gt;
                &lt;/div&gt;
            &lt;?php else: ?&gt;
                &lt;p style=&quot;text-align: center; color: #6c757d; padding: 40px 0; background: #f8f9fa; border-radius: 8px;&quot;&gt;
                    Nenhum registro ativo para preview. Ative pelo menos um para visualizar.
                &lt;/p&gt;
            &lt;?php endif; ?&gt;
        &lt;?php endif; ?&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p><strong>Checklist:</strong></p>

<pre><code>[ ] Preview aparece APENAS se houver registros
[ ] Linha separadora (hr) antes do preview
[ ] Box com c√≥digo para copiar
[ ] Bot√£o &quot;Copiar&quot; funcional (JavaScript)
[ ] Preview renderiza partial real
[ ] Mostra apenas registros ativos
[ ] Mensagem se n√£o houver ativos
</code></pre>

<hr />

<h3 id="passo11b.4:criarsassdocomponentefrontend">PASSO 11B.4: Criar SASS do Componente Frontend</h3>

<p><strong>‚ö†Ô∏è OBRIGAT√ìRIO:</strong> Todo componente frontend precisa do seu pr√≥prio arquivo SASS.</p>

<p><strong>Arquivo: <code>/assets/sass/frontend/components/_[recurso]-display.sass</code></strong></p>

<p><strong>Exemplo: <code>_banner-hero.sass</code></strong></p>

<pre><code class="sass">// ============================================
// COMPONENTE: Banner Hero
// Carrossel de banners principais do site
// ============================================

.c-banner-hero
  position: relative
  width: 100%
  height: 500px
  overflow: hidden
  background: #f5f5f5

  &amp;__slide
    position: absolute
    top: 0
    left: 0
    width: 100%
    height: 100%
    opacity: 0
    transition: opacity 0.5s ease
    background-size: cover
    background-position: center

    &amp;--active
      opacity: 1

  &amp;__content
    position: absolute
    top: 50%
    left: 50px
    transform: translateY(-50%)
    max-width: 600px
    color: white
    z-index: 2

  &amp;__title
    font-size: 48px
    font-weight: 700
    margin-bottom: 20px
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5)

  &amp;__subtitle
    font-size: 24px
    margin-bottom: 30px
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5)

  &amp;__cta
    display: inline-block
    padding: 15px 40px
    background: #6c10b8
    color: white
    text-decoration: none
    border-radius: 4px
    font-weight: 600
    transition: all 0.3s ease

    &amp;:hover
      background: #5a0d9a
      transform: translateY(-2px)
</code></pre>

<p><strong>Checklist de Cria√ß√£o:</strong></p>

<pre><code>[ ] Arquivo criado em /assets/sass/frontend/components/
[ ] Nome: _[recurso]-display.sass (underscore no in√≠cio)
[ ] Nomenclatura BEM: .c-[recurso]__elemento--modificador
[ ] Prefixo 'c-' para components (diferencia de m√≥dulos 'm-')
[ ] Responsive se necess√°rio (@media)
[ ] Vari√°veis do AEGIS ($color-main, $font-title, etc)
</code></pre>

<p><strong>Adicionar import no compilador:</strong></p>

<p><strong>Arquivo: <code>/assets/sass/frontend/components/_components.sass</code></strong></p>

<pre><code class="sass">// Components Frontend - Compilador

@use 'model'
@use 'banner-hero'  // ‚Üê ADICIONAR ESTA LINHA
</code></pre>

<p><strong>Recompilar SASS:</strong></p>

<pre><code class="bash">npm run sass
</code></pre>

<p><strong>Verificar:</strong></p>

<pre><code>[ ] CSS compilado sem erros
[ ] Arquivo /assets/css/frontend.css atualizado
[ ] Classes .c-[recurso]__* existem no CSS final
[ ] Tamanho do arquivo aumentou (confirma que foi inclu√≠do)
</code></pre>

<hr />

<h3 id="passo11b.5:testarpreviewnoadmin">PASSO 11B.5: Testar Preview no Admin</h3>

<p><strong>Acessar: <code>http://localhost:5757/aegis/admin/[recurso]</code></strong></p>

<p><strong>Verificar:</strong></p>

<pre><code>[ ] Se n√£o houver registros ‚Üí preview n√£o aparece
[ ] Se houver registros inativos ‚Üí mensagem &quot;nenhum ativo&quot;
[ ] Se houver ativos ‚Üí preview renderiza corretamente
[ ] Bot√£o &quot;Copiar&quot; funciona
[ ] C√≥digo copiado est√° correto
[ ] Preview tem mesmo visual do frontend
</code></pre>

<hr />

<h3 id="passo11b.5:documentaruso">PASSO 11B.5: Documentar Uso</h3>

<p><strong>No arquivo <code>/docs/crud/implementados/[recurso].md</code>:</strong></p>

<pre><code class="markdown">## üé® Frontend Display

**Controller:** `Frontend[Recurso]Controller`
**Partial:** `/frontend/views/partials/[recurso]-display.php`
**Preview:** Dispon√≠vel em `/admin/[recurso]` (scroll down)

### Como usar em qualquer p√°gina:

</code></pre>

<pre><code class="php">&lt;?php Core::requireInclude('frontend/views/partials/[recurso]-display.php', true); ?&gt;
</code></pre>

<h3 id="caracter√≠sticas:">Caracter√≠sticas:</h3>

<ul>
<li>Mostra apenas registros ativos (ativo = 1)</li>
<li>Ordenado por <code>order</code> ASC</li>
<li>Reutiliz√°vel em m√∫ltiplas p√°ginas</li>
<li>CSS/JS inline (sem depend√™ncias externas)</li>
</ul>

<h3 id="exemplosdeuso:">Exemplos de uso:</h3>

<ul>
<li>Home: <code>/frontend/pages/home.php</code></li>
<li>Sidebar: <code>/frontend/views/partials/sidebar.php</code></li>
<li>Footer: <code>/frontend/views/partials/footer.php</code></li>
</ul>

<pre><code>
---

### ‚úÖ Pronto!

**Seu Admin CRUD + Frontend Display est√° completo:**

- ‚úÖ Admin CRUD gerencia dados
- ‚úÖ Controller frontend busca dados ativos
- ‚úÖ Partial reutiliz√°vel em qualquer lugar
- ‚úÖ Preview no admin com c√≥digo para copiar
- ‚úÖ Documenta√ß√£o de uso

**Pr√≥ximo:** PASSO 12 (Valida√ß√£o Autom√°tica)
## PASSO 12: VALIDA√á√ÉO AUTOM√ÅTICA (RECOMENDADO)

### ü§ñ Validador Autom√°tico de CRUD

**Antes de rodar testes manuais, use o validador autom√°tico:**

</code></pre>

<pre><code class="bash">php scripts/validate-crud.php BannerController
</code></pre>

<p><strong>O que ele verifica:</strong></p>

<ul>
<li>‚úÖ Estrutura: 6 m√©todos, heran√ßa BaseController</li>
<li>‚úÖ Seguran√ßa: CSRF, RateLimit, Auth, Prepared statements</li>
<li>‚úÖ Auditoria: Logger.audit(), Logger.warning(), Exception handling</li>
<li>‚úÖ Valida√ß√£o: Sanitize, UUID, Empty checks</li>
<li>‚úÖ Nomenclatura: Actions mai√∫sculas, RateLimiter keys consistentes</li>
</ul>

<p><strong>Resultado esperado:</strong></p>

<pre><code>‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
SCORE: 15/15 (100%)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

‚úÖ CRUD V√ÅLIDO!

Seu controller passou em todos os checks obrigat√≥rios.
Est√° pronto para produ√ß√£o.
</code></pre>

<p><strong>Se score &lt; 100%:</strong></p>

<ul>
<li>Revise os itens marcados com ‚ùå</li>
<li>Corrija o c√≥digo</li>
<li>Rode o validador novamente</li>
</ul>

<hr />

<h2 id="passo13:entregar">PASSO 13: ENTREGAR</h2>

<h3 id="üîígatefinal-testesobrigat√ìriosantesdeentregar">üîí GATE FINAL - TESTES OBRIGAT√ìRIOS ANTES DE ENTREGAR</h3>

<p><strong>‚õî N√ÉO ENTREGUE SEM PASSAR NESTES TESTES</strong></p>

<pre><code>üß™ TESTE 1: FUNCIONALIDADE B√ÅSICA (OBRIGAT√ìRIO)
[ ] Acessar /admin/[recurso] ‚Üí lista aparece sem erro 500?
[ ] Acessar /admin/[recurso]/create ‚Üí form aparece sem erro 500?
[ ] Submeter create ‚Üí registro criado no banco?
[ ] Acessar /admin/[recurso]/[id]/edit ‚Üí form aparece com dados?
[ ] Submeter edit ‚Üí registro atualizado no banco?
[ ] Submeter delete ‚Üí registro removido do banco?
‚ö†Ô∏è SE ALGUM FALHOU: DEBUGAR E CORRIGIR AGORA!

üîí TESTE 2: SEGURAN√áA (OBRIGAT√ìRIO)
[ ] Remover CSRF token do form ‚Üí submit bloqueado com erro?
[ ] Fazer 10 submits r√°pidos ‚Üí rate limit bloqueou?
[ ] Verificar banco: tabela logs_audit tem registros CREATE/UPDATE/DELETE?
[ ] SQL Injection: tentar ' OR 1=1 -- em campo ‚Üí bloqueado?
‚ö†Ô∏è SE ALGUM FALHOU: SEU CRUD EST√Å VULNER√ÅVEL! CORRIJA!

üìÅ TESTE 3: PERMISS√ïES (OBRIGAT√ìRIO - 30% de erro)
[ ] Executar: ls -la /admin/views/[recurso]/*.php
[ ] TODOS arquivos t√™m permiss√£o 644?
[ ] Se N√ÉO: chmod 644 /admin/views/[recurso]/*.php
‚ö†Ô∏è PERMISS√ïES ERRADAS = ERRO 500 SILENCIOSO!

üìä TESTE 4: LOGS E AUDITORIA (OBRIGAT√ìRIO)
[ ] Executar: SELECT * FROM logs_audit WHERE action LIKE 'CREATE_%' ORDER BY created_at DESC LIMIT 5
[ ] Logs aparecem com user_id, ip, resource_id, table?
[ ] Logs de DELETE t√™m snapshot de dados deletados?
‚ö†Ô∏è SE LOGS N√ÉO APARECEM: Logger n√£o est√° funcionando!
</code></pre>

<hr />

<h3 id="‚úÖchecklistfinaldeentrega">‚úÖ CHECKLIST FINAL DE ENTREGA</h3>

<p><strong>S√ì MARQUE COMO COMPLETO AP√ìS PASSAR NOS 4 TESTES ACIMA</strong></p>

<pre><code>[ ] ‚úÖ TESTE 1 passou (funcionalidade)
[ ] ‚úÖ TESTE 2 passou (seguran√ßa)
[ ] ‚úÖ TESTE 3 passou (permiss√µes)
[ ] ‚úÖ TESTE 4 passou (auditoria)

ARQUIVOS:
[ ] Arquivo controller salvo
[ ] Arquivo routes modificado
[ ] Views criadas com chmod 644
[ ] Frontend page modificado (se aplic√°vel)

GIT:
[ ] Commit feito
[ ] Mensagem de commit clara
[ ] Testado no browser AP√ìS commit

DOCUMENTA√á√ÉO:
[ ] Se comportamento especial: documentado em coment√°rios
[ ] Se API: endpoints documentados
</code></pre>

<hr />

<h3 id="üéâaprova√á√Éofinal">üéâ APROVA√á√ÉO FINAL</h3>

<p><strong>SE TODOS OS 4 TESTES PASSARAM E CHECKLIST EST√Å 100%:</strong></p>

<pre><code>‚úÖ SEU CRUD EST√Å PRONTO PARA PRODU√á√ÉO!
‚úÖ Seguran√ßa: OWASP Top 10 compliant
‚úÖ Auditoria: Todas a√ß√µes logadas
‚úÖ Performance: Rate limiting ativo
‚úÖ Funcionalidade: Testada e validada

üëâ PODE ENTREGAR COM CONFIAN√áA!
</code></pre>

<p><strong>SE ALGUM TESTE FALHOU:</strong></p>

<pre><code>‚õî N√ÉO ENTREGUE COM FALHAS!
‚õî VOLTE, CORRIJA E TESTE NOVAMENTE
‚õî C√ìDIGO COM BUGS = RETRABALHO = TEMPO PERDIDO
</code></pre>

<hr />

<h2 id="refer√änciar√Åpida-nomesdea√á√Éo">REFER√äNCIA R√ÅPIDA - NOMES DE A√á√ÉO</h2>

<p><strong>Use exatamente assim:</strong></p>

<table>
<colgroup>
<col />
<col />
<col />
</colgroup>

<thead>
<tr>
	<th> Opera√ß√£o </th>
	<th> Nome </th>
	<th> Exemplo </th>
</tr>
</thead>

<tbody>
<tr>
	<td> Criar </td>
	<td> CREATE_RECURSO </td>
	<td> CREATE_CATEGORY </td>
</tr>
<tr>
	<td> Atualizar </td>
	<td> UPDATE_RECURSO </td>
	<td> UPDATE_MEMBER </td>
</tr>
<tr>
	<td> Deletar </td>
	<td> DELETE_RECURSO </td>
	<td> DELETE_POST </td>
</tr>
<tr>
	<td> Erro de cria√ß√£o </td>
	<td> CREATE_RECURSO_FAILED </td>
	<td> CREATE_CATEGORY_FAILED </td>
</tr>
<tr>
	<td> Erro de update </td>
	<td> UPDATE_RECURSO_FAILED </td>
	<td> UPDATE_MEMBER_FAILED </td>
</tr>
<tr>
	<td> Erro de dele√ß√£o </td>
	<td> DELETE_RECURSO_FAILED </td>
	<td> DELETE_POST_FAILED </td>
</tr>
</tbody>
</table>

<p><strong>SEMPRE singular, SEMPRE mai√∫sculas.</strong></p>

<hr />

<h2 id="refer√änciar√Åpida-ratelimits">REFER√äNCIA R√ÅPIDA - RATE LIMITS</h2>

<table>
<colgroup>
<col />
<col />
<col />
</colgroup>

<thead>
<tr>
	<th> Tipo </th>
	<th> Limite </th>
	<th> Janela </th>
</tr>
</thead>

<tbody>
<tr>
	<td> store </td>
	<td> 5 </td>
	<td> 60s </td>
</tr>
<tr>
	<td> update </td>
	<td> 10 </td>
	<td> 60s </td>
</tr>
<tr>
	<td> destroy </td>
	<td> 5 </td>
	<td> 60s </td>
</tr>
<tr>
	<td> API index/show </td>
	<td> 60 </td>
	<td> 60s </td>
</tr>
<tr>
	<td> login (especial) </td>
	<td> 5 </td>
	<td> 300s </td>
</tr>
</tbody>
</table>

<hr />

<h2 id="refer√änciar√Åpida-consultarsetiverd√övida">REFER√äNCIA R√ÅPIDA - CONSULTAR SE TIVER D√öVIDA</h2>

<table>
<colgroup>
<col />
<col />
</colgroup>

<thead>
<tr>
	<th> D√∫vida </th>
	<th> Arquivo </th>
</tr>
</thead>

<tbody>
<tr>
	<td> &#8220;Como fazer CSRF?&#8221; </td>
	<td> MASTER-CHECKLIST-SEGURANCA.md se√ß√£o 1 </td>
</tr>
<tr>
	<td> &#8220;Como fazer RateLimit?&#8221; </td>
	<td> MASTER-CHECKLIST-SEGURANCA.md se√ß√£o 2 </td>
</tr>
<tr>
	<td> &#8220;Como validar email?&#8221; </td>
	<td> MASTER-CHECKLIST-VALIDACAO.md se√ß√£o 2 </td>
</tr>
<tr>
	<td> &#8220;Como fazer Logger?&#8221; </td>
	<td> MASTER-CHECKLIST-AUDITORIA.md se√ß√£o 1&#8211;3 </td>
</tr>
<tr>
	<td> &#8220;Preciso de exemplo completo?&#8221; </td>
	<td> TEMPLATE-CRUD-*.md </td>
</tr>
</tbody>
</table>

<hr />

<h2 id="pr√ìximo:fazernapr√Åtica">PR√ìXIMO: FAZER NA PR√ÅTICA</h2>

<p><strong>Quando estiver pronto, escolha um CRUD dos 31 e execute este guia.</strong></p>

<p>Eu vou seguir exatamente estes passos.</p>

</body>
</html>

